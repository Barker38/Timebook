2025-03-27 09:53:54.716 +08:00 [INF] Starting RFID Server...
2025-03-27 09:53:54.754 +08:00 [INF] Connecting to WebSocket...
2025-03-27 09:53:54.800 +08:00 [INF] WebSocket connected successfully
2025-03-27 09:53:54.810 +08:00 [INF] RFID reader connected to COM3
2025-03-27 09:54:14.046 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 09:54:14.052 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 09:54:14.055 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 09:54:14.132 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 09:54:15.148 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 09:54:17.163 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 09:54:20.253 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 09:54:21.257 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 09:54:23.267 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 09:54:26.385 +08:00 [DBG] Received data: No card
2025-03-27 09:54:26.494 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 09:54:26.495 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 09:54:26.496 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 09:54:26.497 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 09:54:27.503 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 09:54:29.514 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 09:54:32.555 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 09:54:33.567 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 09:54:35.577 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 09:54:38.699 +08:00 [DBG] Received data: No card
2025-03-27 09:54:42.308 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 09:54:42.311 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 09:54:42.311 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 09:54:42.312 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 09:54:43.323 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 09:54:45.330 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 09:54:48.378 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 09:54:49.391 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 09:54:51.400 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 09:54:53.261 +08:00 [INF] Cleaning up resources...
2025-03-27 09:54:53.265 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.SendAsyncForNetworkStream(ReadOnlyMemory`1 buffer, SocketFlags socketFlags, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_1>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 32
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_1(Object sender, ConsoleCancelEventArgs e)
   at System.Console.HandlePosixSignal(PosixSignalContext ctx)
   at System.Runtime.InteropServices.PosixSignalRegistration.HandlerRoutine(Int32 dwCtrlType)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 09:54:53.272 +08:00 [INF] Cleaning up resources...
2025-03-27 09:54:53.273 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.SendAsyncForNetworkStream(ReadOnlyMemory`1 buffer, SocketFlags socketFlags, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_0>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 26
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_0(Object s, EventArgs e)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 10:12:40.992 +08:00 [INF] Starting RFID Server...
2025-03-27 10:12:41.061 +08:00 [INF] Connecting to WebSocket...
2025-03-27 10:12:41.129 +08:00 [INF] WebSocket connected successfully
2025-03-27 10:12:41.146 +08:00 [INF] RFID reader connected to COM3
2025-03-27 10:12:47.938 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:12:47.942 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:12:47.945 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:12:47.998 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:12:47.9469774Z"}}
2025-03-27 10:12:48.088 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:12:48.0864700Z"}}
2025-03-27 10:12:48.304 +08:00 [DBG] Received data: No card
2025-03-27 10:12:59.805 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:12:59.807 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:12:59.807 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:12:59.808 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:12:59.8080773Z"}}
2025-03-27 10:12:59.843 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:12:59.8432081Z"}}
2025-03-27 10:13:00.177 +08:00 [DBG] Received data: No card
2025-03-27 10:13:44.208 +08:00 [INF] Cleaning up resources...
2025-03-27 10:13:44.209 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 121
2025-03-27 10:13:44.216 +08:00 [ERR] Error during resource cleanup
System.ObjectDisposedException: The CancellationTokenSource has been disposed.
   at System.Threading.CancellationTokenSource.Cancel()
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 266
2025-03-27 10:13:47.043 +08:00 [INF] Starting RFID Server...
2025-03-27 10:13:47.083 +08:00 [INF] Connecting to WebSocket...
2025-03-27 10:13:47.127 +08:00 [INF] WebSocket connected successfully
2025-03-27 10:13:47.148 +08:00 [INF] RFID reader connected to COM3
2025-03-27 10:14:18.555 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:14:18.559 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:14:18.561 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:14:18.608 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 10:14:19.613 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 10:14:21.627 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 10:14:24.725 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 10:14:25.735 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 10:14:27.746 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 10:14:30.862 +08:00 [DBG] Received data: No card
2025-03-27 10:14:30.972 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:14:30.976 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:14:30.977 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:14:30.978 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 10:14:31.985 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 10:14:33.998 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 10:14:37.152 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 10:14:38.161 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 10:14:40.176 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 10:14:43.291 +08:00 [DBG] Received data: No card
2025-03-27 10:14:56.056 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:14:56.057 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:14:56.059 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:14:56.060 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 10:14:57.074 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 10:14:59.087 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 10:15:02.130 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 10:15:03.138 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 10:15:05.148 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 10:15:08.272 +08:00 [DBG] Received data: No card
2025-03-27 10:15:09.462 +08:00 [INF] Cleaning up resources...
2025-03-27 10:15:09.463 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 121
2025-03-27 10:15:09.466 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.SendAsyncForNetworkStream(ReadOnlyMemory`1 buffer, SocketFlags socketFlags, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_1>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 32
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_1(Object sender, ConsoleCancelEventArgs e)
   at System.Console.HandlePosixSignal(PosixSignalContext ctx)
   at System.Runtime.InteropServices.PosixSignalRegistration.HandlerRoutine(Int32 dwCtrlType)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 10:15:09.473 +08:00 [INF] Cleaning up resources...
2025-03-27 10:15:09.474 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.SendAsyncForNetworkStream(ReadOnlyMemory`1 buffer, SocketFlags socketFlags, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_0>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 26
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_0(Object s, EventArgs e)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 10:15:11.842 +08:00 [INF] Starting RFID Server...
2025-03-27 10:15:11.878 +08:00 [INF] Connecting to WebSocket...
2025-03-27 10:15:11.924 +08:00 [INF] WebSocket connected successfully
2025-03-27 10:15:11.943 +08:00 [INF] RFID reader connected to COM3
2025-03-27 10:15:23.058 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:15:23.062 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:15:23.063 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:15:23.108 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:15:23.0644320Z"}}
2025-03-27 10:15:23.167 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:15:23.1643515Z"}}
2025-03-27 10:15:23.494 +08:00 [DBG] Received data: No card
2025-03-27 10:15:40.946 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:15:40.950 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:15:40.951 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:15:40.952 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:15:40.9518606Z"}}
2025-03-27 10:15:40.985 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:15:40.9855239Z"}}
2025-03-27 10:15:41.320 +08:00 [DBG] Received data: No card
2025-03-27 10:16:20.901 +08:00 [INF] Cleaning up resources...
2025-03-27 10:16:20.902 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 121
2025-03-27 10:16:20.908 +08:00 [ERR] Error during resource cleanup
System.ObjectDisposedException: The CancellationTokenSource has been disposed.
   at System.Threading.CancellationTokenSource.Cancel()
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 266
2025-03-27 10:18:17.246 +08:00 [INF] Starting RFID Server...
2025-03-27 10:18:17.280 +08:00 [INF] Connecting to WebSocket...
2025-03-27 10:18:17.326 +08:00 [INF] WebSocket connected successfully
2025-03-27 10:18:17.339 +08:00 [INF] RFID reader connected to COM3
2025-03-27 10:18:35.664 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:18:35.668 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:18:35.670 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:18:35.720 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:18:35.6718650Z"}}
2025-03-27 10:18:35.781 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:18:35.7775023Z"}}
2025-03-27 10:18:36.003 +08:00 [DBG] Received data: No card
2025-03-27 10:18:42.768 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:18:42.772 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:18:42.773 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:18:42.774 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:18:42.7740031Z"}}
2025-03-27 10:18:42.778 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:18:42.7785120Z"}}
2025-03-27 10:18:43.217 +08:00 [DBG] Received data: No card
2025-03-27 10:20:57.503 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:20:57.508 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:20:57.509 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:20:57.509 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:20:57.5094964Z"}}
2025-03-27 10:20:57.546 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:20:57.5463558Z"}}
2025-03-27 10:23:56.587 +08:00 [DBG] Received data: No card
2025-03-27 10:23:58.220 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:23:58.224 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:23:58.225 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:23:58.226 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:23:58.2263162Z"}}
2025-03-27 10:23:58.259 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:23:58.2594944Z"}}
2025-03-27 10:23:58.603 +08:00 [DBG] Received data: No card
2025-03-27 10:24:04.167 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:24:04.171 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:24:04.174 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:24:04.175 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:24:04.1751452Z"}}
2025-03-27 10:24:04.179 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:24:04.1789923Z"}}
2025-03-27 10:24:04.618 +08:00 [DBG] Received data: No card
2025-03-27 10:24:10.226 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:24:10.231 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:24:10.232 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:24:10.232 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:24:10.2326959Z"}}
2025-03-27 10:24:10.236 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:24:10.2364954Z"}}
2025-03-27 10:24:10.554 +08:00 [DBG] Received data: No card
2025-03-27 10:24:14.065 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:24:14.067 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:24:14.068 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:24:14.068 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:24:14.0684514Z"}}
2025-03-27 10:24:14.071 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:24:14.0715416Z"}}
2025-03-27 10:24:14.509 +08:00 [DBG] Received data: No card
2025-03-27 10:46:38.288 +08:00 [INF] Cleaning up resources...
2025-03-27 10:46:38.288 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 121
2025-03-27 10:46:38.297 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_1>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 32
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_1(Object sender, ConsoleCancelEventArgs e)
   at System.Console.HandlePosixSignal(PosixSignalContext ctx)
   at System.Runtime.InteropServices.PosixSignalRegistration.HandlerRoutine(Int32 dwCtrlType)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 10:46:38.304 +08:00 [INF] Cleaning up resources...
2025-03-27 10:46:38.305 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_0>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 26
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_0(Object s, EventArgs e)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 10:46:47.935 +08:00 [INF] Starting RFID Server...
2025-03-27 10:46:47.972 +08:00 [INF] Connecting to WebSocket...
2025-03-27 10:46:48.020 +08:00 [INF] WebSocket connected successfully
2025-03-27 10:46:48.039 +08:00 [INF] RFID reader connected to COM3
2025-03-27 10:47:01.981 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:47:01.985 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:47:01.987 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:47:02.033 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:47:01.9891724Z"}}
2025-03-27 10:47:02.093 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:47:02.0900266Z"}}
2025-03-27 10:47:02.316 +08:00 [DBG] Received data: No card
2025-03-27 10:47:10.970 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:47:10.974 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:47:10.974 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:47:10.975 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:47:10.9754022Z"}}
2025-03-27 10:47:10.980 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:47:10.9800037Z"}}
2025-03-27 10:47:11.409 +08:00 [DBG] Received data: No card
2025-03-27 10:47:14.712 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:47:14.714 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:47:14.714 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:47:14.715 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:47:14.7151926Z"}}
2025-03-27 10:47:14.718 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:47:14.7182752Z"}}
2025-03-27 10:47:15.264 +08:00 [DBG] Received data: No card
2025-03-27 10:47:24.422 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:47:24.427 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:47:24.427 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:47:24.428 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:47:24.4282838Z"}}
2025-03-27 10:47:24.432 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:47:24.4322143Z"}}
2025-03-27 10:47:24.655 +08:00 [DBG] Received data: No card
2025-03-27 10:47:40.591 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:47:40.595 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:47:40.596 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:47:40.597 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:47:40.5968112Z"}}
2025-03-27 10:47:40.747 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:47:40.7471919Z"}}
2025-03-27 10:47:41.079 +08:00 [DBG] Received data: No card
2025-03-27 10:47:42.281 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:47:42.286 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:47:42.287 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:47:42.288 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:47:42.2884150Z"}}
2025-03-27 10:47:42.291 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:47:42.2914743Z"}}
2025-03-27 10:47:42.622 +08:00 [DBG] Received data: No card
2025-03-27 10:47:43.604 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:47:43.607 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:47:43.607 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:47:43.608 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:47:43.6086458Z"}}
2025-03-27 10:47:43.611 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:47:43.6112495Z"}}
2025-03-27 10:47:44.038 +08:00 [DBG] Received data: No card
2025-03-27 10:53:37.058 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:53:37.060 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:53:37.061 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:53:37.062 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:53:37.0621692Z"}}
2025-03-27 10:53:37.067 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:53:37.0670765Z"}}
2025-03-27 10:53:37.287 +08:00 [DBG] Received data: No card
2025-03-27 10:53:41.108 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:53:41.112 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:53:41.113 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:53:41.113 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:53:41.1135729Z"}}
2025-03-27 10:53:41.117 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:53:41.1173567Z"}}
2025-03-27 10:53:41.556 +08:00 [DBG] Received data: No card
2025-03-27 10:53:49.330 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:53:49.333 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:53:49.334 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:53:49.334 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:53:49.3345314Z"}}
2025-03-27 10:53:49.338 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:53:49.3386005Z"}}
2025-03-27 10:53:49.769 +08:00 [DBG] Received data: No card
2025-03-27 10:57:40.606 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:57:40.610 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:57:40.611 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:57:40.612 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:57:40.6120067Z"}}
2025-03-27 10:57:40.616 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:57:40.6168246Z"}}
2025-03-27 10:57:41.053 +08:00 [DBG] Received data: No card
2025-03-27 10:57:46.189 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:57:46.194 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:57:46.196 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:57:46.197 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:57:46.1977311Z"}}
2025-03-27 10:57:46.201 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:57:46.2012421Z"}}
2025-03-27 10:57:46.644 +08:00 [DBG] Received data: No card
2025-03-27 10:58:42.833 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:58:42.834 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:58:42.835 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:58:42.836 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:58:42.8364204Z"}}
2025-03-27 10:58:42.839 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:58:42.8398183Z"}}
2025-03-27 10:58:43.277 +08:00 [DBG] Received data: No card
2025-03-27 10:59:04.073 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:59:04.074 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:59:04.075 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:59:04.077 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:59:04.0769079Z"}}
2025-03-27 10:59:04.080 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:59:04.0799854Z"}}
2025-03-27 10:59:04.515 +08:00 [DBG] Received data: No card
2025-03-27 10:59:10.225 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:59:10.227 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:59:10.227 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:59:10.228 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:59:10.2284649Z"}}
2025-03-27 10:59:10.231 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:59:10.2316553Z"}}
2025-03-27 10:59:10.661 +08:00 [DBG] Received data: No card
2025-03-27 10:59:11.542 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:59:11.544 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:59:11.545 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:59:11.545 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:59:11.5455988Z"}}
2025-03-27 10:59:11.547 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T02:59:11.5475037Z"}}
2025-03-27 10:59:11.877 +08:00 [DBG] Received data: No card
2025-03-27 10:59:42.987 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 10:59:42.988 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 10:59:42.989 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 10:59:42.990 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T02:59:42.9898579Z"}}
2025-03-27 10:59:42.999 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B4FCBC2D","employee":{"id":7,"card_number":"B4FCBC2D","name":"Учанмн","position":null,"created_at":"2025-03-27T02:59:36.897Z"},"timestamp":"2025-03-27T02:59:42.9959767Z"}
2025-03-27 10:59:43.430 +08:00 [DBG] Received data: No card
2025-03-27 11:00:45.769 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:00:45.770 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:00:45.771 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:00:45.771 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:00:45.7716559Z"}}
2025-03-27 11:00:45.803 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B4FCBC2D","employee":{"id":7,"card_number":"B4FCBC2D","name":"Учанмн","position":null,"created_at":"2025-03-27T02:59:36.897Z"},"timestamp":"2025-03-27T03:00:45.8030996Z"}
2025-03-27 11:00:46.239 +08:00 [DBG] Received data: No card
2025-03-27 11:07:27.624 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:07:27.625 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:07:27.626 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:07:27.627 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:07:27.6272897Z"}}
2025-03-27 11:07:27.631 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:07:27.6311425Z"}}
2025-03-27 11:07:27.966 +08:00 [DBG] Received data: No card
2025-03-27 11:07:38.643 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:07:38.645 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:07:38.646 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:07:38.646 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:07:38.6466330Z"}}
2025-03-27 11:07:38.650 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:07:38.6501441Z"}}
2025-03-27 11:07:38.974 +08:00 [DBG] Received data: No card
2025-03-27 11:08:37.977 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:08:37.979 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:08:37.979 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:08:37.979 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:08:37.9798181Z"}}
2025-03-27 11:08:38.010 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:08:38.0104267Z"}}
2025-03-27 11:08:38.451 +08:00 [DBG] Received data: No card
2025-03-27 11:08:39.705 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:08:39.707 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:08:39.707 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:08:39.708 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:08:39.7083022Z"}}
2025-03-27 11:08:39.710 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:08:39.7107885Z"}}
2025-03-27 11:08:40.043 +08:00 [DBG] Received data: No card
2025-03-27 11:09:40.928 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:09:40.929 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:09:40.930 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:09:40.931 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:09:40.9308192Z"}}
2025-03-27 11:09:40.961 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:09:40.9613383Z"}}
2025-03-27 11:09:41.289 +08:00 [DBG] Received data: No card
2025-03-27 11:19:30.045 +08:00 [INF] Cleaning up resources...
2025-03-27 11:19:30.046 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 121
2025-03-27 11:19:30.066 +08:00 [ERR] Error during resource cleanup
System.ObjectDisposedException: The CancellationTokenSource has been disposed.
   at System.Threading.CancellationTokenSource.Cancel()
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 266
2025-03-27 11:19:32.627 +08:00 [INF] Starting RFID Server...
2025-03-27 11:19:32.667 +08:00 [INF] Connecting to WebSocket...
2025-03-27 11:19:32.713 +08:00 [INF] WebSocket connected successfully
2025-03-27 11:19:32.729 +08:00 [INF] RFID reader connected to COM3
2025-03-27 11:19:38.605 +08:00 [INF] Cleaning up resources...
2025-03-27 11:19:38.607 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 121
2025-03-27 11:19:38.617 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.SendAsyncForNetworkStream(ReadOnlyMemory`1 buffer, SocketFlags socketFlags, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_1>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 32
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_1(Object sender, ConsoleCancelEventArgs e)
   at System.Console.HandlePosixSignal(PosixSignalContext ctx)
   at System.Runtime.InteropServices.PosixSignalRegistration.HandlerRoutine(Int32 dwCtrlType)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 11:19:38.627 +08:00 [INF] Cleaning up resources...
2025-03-27 11:19:38.628 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.SendAsyncForNetworkStream(ReadOnlyMemory`1 buffer, SocketFlags socketFlags, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_0>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 26
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_0(Object s, EventArgs e)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 11:19:40.799 +08:00 [INF] Starting RFID Server...
2025-03-27 11:19:40.837 +08:00 [INF] Connecting to WebSocket...
2025-03-27 11:19:40.883 +08:00 [INF] WebSocket connected successfully
2025-03-27 11:19:40.903 +08:00 [INF] RFID reader connected to COM3
2025-03-27 11:19:48.360 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:19:48.364 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:19:48.365 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:19:48.422 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:19:48.3664944Z"}}
2025-03-27 11:19:48.517 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:19:48.5140666Z"}}
2025-03-27 11:19:48.739 +08:00 [DBG] Received data: No card
2025-03-27 11:19:55.674 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:19:55.676 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:19:55.676 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:19:55.677 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:19:55.6773643Z"}}
2025-03-27 11:19:55.682 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:19:55.6823273Z"}}
2025-03-27 11:19:56.021 +08:00 [DBG] Received data: No card
2025-03-27 11:20:50.748 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:20:50.750 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:20:50.751 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:20:50.751 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:20:50.7514154Z"}}
2025-03-27 11:20:50.783 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:20:50.7828326Z"}}
2025-03-27 11:20:51.112 +08:00 [DBG] Received data: No card
2025-03-27 11:20:53.762 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:20:53.763 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:20:53.763 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:20:53.764 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:20:53.7639112Z"}}
2025-03-27 11:20:53.766 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:20:53.7665086Z"}}
2025-03-27 11:20:53.983 +08:00 [DBG] Received data: No card
2025-03-27 11:21:07.476 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:21:07.478 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:21:07.479 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:21:07.480 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:21:07.4798277Z"}}
2025-03-27 11:21:07.509 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:21:07.5097889Z"}}
2025-03-27 11:21:07.855 +08:00 [DBG] Received data: No card
2025-03-27 11:21:39.809 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:21:39.810 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:21:39.811 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:21:39.811 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:21:39.8116628Z"}}
2025-03-27 11:21:39.844 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:21:39.8446111Z"}}
2025-03-27 11:21:40.180 +08:00 [DBG] Received data: No card
2025-03-27 11:21:44.367 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:21:44.369 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:21:44.369 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:21:44.370 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:21:44.3701059Z"}}
2025-03-27 11:21:44.375 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:21:44.3748648Z"}}
2025-03-27 11:21:44.817 +08:00 [DBG] Received data: No card
2025-03-27 11:24:12.414 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:24:12.416 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:24:12.416 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:24:12.417 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:24:12.4173385Z"}}
2025-03-27 11:24:12.422 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:24:12.4223764Z"}}
2025-03-27 11:24:12.853 +08:00 [DBG] Received data: No card
2025-03-27 11:24:28.102 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:24:28.104 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:24:28.104 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:24:28.113 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 11:24:29.124 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 11:24:31.131 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 11:24:34.145 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 11:24:35.147 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 11:24:37.159 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 11:24:40.277 +08:00 [DBG] Received data: No card
2025-03-27 11:25:50.717 +08:00 [INF] Cleaning up resources...
2025-03-27 11:25:50.717 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 121
2025-03-27 11:25:50.720 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_1>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 32
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_1(Object sender, ConsoleCancelEventArgs e)
   at System.Console.HandlePosixSignal(PosixSignalContext ctx)
   at System.Runtime.InteropServices.PosixSignalRegistration.HandlerRoutine(Int32 dwCtrlType)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 11:25:50.725 +08:00 [INF] Cleaning up resources...
2025-03-27 11:25:50.727 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_0>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 26
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_0(Object s, EventArgs e)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 11:25:53.051 +08:00 [INF] Starting RFID Server...
2025-03-27 11:25:53.089 +08:00 [INF] Connecting to WebSocket...
2025-03-27 11:25:53.134 +08:00 [INF] WebSocket connected successfully
2025-03-27 11:25:53.148 +08:00 [INF] RFID reader connected to COM3
2025-03-27 11:26:01.494 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:26:01.498 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:26:01.500 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:26:01.550 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:26:01.5013420Z"}}
2025-03-27 11:26:01.639 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:26:01.6372557Z"}}
2025-03-27 11:26:01.866 +08:00 [DBG] Received data: No card
2025-03-27 11:28:19.209 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:28:19.211 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:28:19.212 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:28:19.213 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:28:19.2134636Z"}}
2025-03-27 11:28:19.352 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:28:19.3522487Z"}}
2025-03-27 11:28:19.569 +08:00 [DBG] Received data: No card
2025-03-27 11:28:32.551 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:28:32.552 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:28:32.553 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:28:32.553 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:28:32.5535610Z"}}
2025-03-27 11:28:32.585 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:28:32.5857851Z"}}
2025-03-27 11:28:33.022 +08:00 [DBG] Received data: No card
2025-03-27 11:28:49.237 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:28:49.239 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:28:49.239 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:28:49.240 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:28:49.2405978Z"}}
2025-03-27 11:28:49.383 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:28:49.3837194Z"}}
2025-03-27 11:28:49.597 +08:00 [DBG] Received data: No card
2025-03-27 11:30:19.789 +08:00 [INF] Cleaning up resources...
2025-03-27 11:30:19.790 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 121
2025-03-27 11:30:19.795 +08:00 [ERR] Error during resource cleanup
System.ObjectDisposedException: The CancellationTokenSource has been disposed.
   at System.Threading.CancellationTokenSource.Cancel()
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 266
2025-03-27 11:30:28.775 +08:00 [INF] Starting RFID Server...
2025-03-27 11:30:28.815 +08:00 [INF] Connecting to WebSocket...
2025-03-27 11:30:28.864 +08:00 [INF] WebSocket connected successfully
2025-03-27 11:30:28.888 +08:00 [INF] RFID reader connected to COM3
2025-03-27 11:30:36.809 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:30:36.813 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:30:36.814 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:30:36.860 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:30:36.8158319Z"}}
2025-03-27 11:30:37.062 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:30:37.0604259Z"}}
2025-03-27 11:30:37.166 +08:00 [DBG] Received data: No card
2025-03-27 11:30:54.861 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:30:54.863 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:30:54.864 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:30:54.865 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:30:54.8649488Z"}}
2025-03-27 11:30:54.869 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:30:54.8692244Z"}}
2025-03-27 11:30:55.301 +08:00 [DBG] Received data: No card
2025-03-27 11:42:52.973 +08:00 [INF] Cleaning up resources...
2025-03-27 11:42:52.983 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_1>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 32
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_1(Object sender, ConsoleCancelEventArgs e)
   at System.Console.HandlePosixSignal(PosixSignalContext ctx)
   at System.Runtime.InteropServices.PosixSignalRegistration.HandlerRoutine(Int32 dwCtrlType)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 11:42:52.993 +08:00 [INF] Cleaning up resources...
2025-03-27 11:42:52.994 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_0>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 26
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_0(Object s, EventArgs e)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 11:43:10.043 +08:00 [INF] Starting RFID Server...
2025-03-27 11:43:10.081 +08:00 [INF] Connecting to WebSocket...
2025-03-27 11:43:10.128 +08:00 [INF] WebSocket connected successfully
2025-03-27 11:43:10.141 +08:00 [INF] RFID reader connected to COM3
2025-03-27 11:43:58.240 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:43:58.244 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:43:58.245 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:43:58.291 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:43:58.2468799Z"}}
2025-03-27 11:43:58.385 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:43:58.3828526Z"}}
2025-03-27 11:43:58.599 +08:00 [DBG] Received data: No card
2025-03-27 11:45:06.027 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:45:06.030 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:45:06.030 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:45:06.031 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:45:06.0310752Z"}}
2025-03-27 11:45:06.173 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:45:06.1731362Z"}}
2025-03-27 11:45:06.386 +08:00 [DBG] Received data: No card
2025-03-27 11:51:18.349 +08:00 [INF] Cleaning up resources...
2025-03-27 11:51:18.350 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 121
2025-03-27 11:51:18.359 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.SendAsyncForNetworkStream(ReadOnlyMemory`1 buffer, SocketFlags socketFlags, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_1>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 32
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_1(Object sender, ConsoleCancelEventArgs e)
   at System.Console.HandlePosixSignal(PosixSignalContext ctx)
   at System.Runtime.InteropServices.PosixSignalRegistration.HandlerRoutine(Int32 dwCtrlType)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 11:51:18.367 +08:00 [INF] Cleaning up resources...
2025-03-27 11:51:18.368 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.SendAsyncForNetworkStream(ReadOnlyMemory`1 buffer, SocketFlags socketFlags, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_0>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 26
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_0(Object s, EventArgs e)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 11:51:27.054 +08:00 [INF] Starting RFID Server...
2025-03-27 11:51:27.094 +08:00 [INF] Connecting to WebSocket...
2025-03-27 11:51:27.142 +08:00 [INF] WebSocket connected successfully
2025-03-27 11:51:27.165 +08:00 [INF] RFID reader connected to COM3
2025-03-27 11:51:42.093 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:51:42.097 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:51:42.100 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:51:42.166 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:51:42.1017914Z"}}
2025-03-27 11:51:42.232 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:51:42.2303330Z"}}
2025-03-27 11:51:42.448 +08:00 [DBG] Received data: No card
2025-03-27 11:51:46.409 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:51:46.411 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:51:46.412 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:51:46.413 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:51:46.4134858Z"}}
2025-03-27 11:51:46.419 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:51:46.4191378Z"}}
2025-03-27 11:51:46.752 +08:00 [DBG] Received data: No card
2025-03-27 11:51:53.246 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:51:53.247 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:51:53.248 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:51:53.249 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:51:53.2489378Z"}}
2025-03-27 11:51:53.252 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:51:53.2523661Z"}}
2025-03-27 11:51:53.470 +08:00 [DBG] Received data: No card
2025-03-27 11:52:04.092 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:52:04.093 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:52:04.094 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:52:04.094 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:52:04.0947571Z"}}
2025-03-27 11:52:04.236 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:52:04.2362530Z"}}
2025-03-27 11:52:04.451 +08:00 [DBG] Received data: No card
2025-03-27 11:52:05.576 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:52:05.578 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:52:05.578 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:52:05.580 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:52:05.5802352Z"}}
2025-03-27 11:52:05.583 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:52:05.5830711Z"}}
2025-03-27 11:52:25.552 +08:00 [DBG] Received data: No card
2025-03-27 11:52:26.434 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:52:26.436 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:52:26.437 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:52:26.437 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:52:26.4373938Z"}}
2025-03-27 11:52:26.447 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B4FCBC2D","employee":{"id":9,"card_number":"B4FCBC2D","name":"Учанмн","position":"Прог","created_at":"2025-03-27T03:52:19.026Z"},"timestamp":"2025-03-27T03:52:26.4437883Z"}
2025-03-27 11:52:26.890 +08:00 [DBG] Received data: No card
2025-03-27 11:54:27.713 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:54:27.716 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:54:27.717 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:54:27.720 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 11:54:28.722 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 11:54:30.727 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 11:54:32.180 +08:00 [INF] Cleaning up resources...
2025-03-27 11:54:32.183 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.SendAsyncForNetworkStream(ReadOnlyMemory`1 buffer, SocketFlags socketFlags, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_1>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 32
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_1(Object sender, ConsoleCancelEventArgs e)
   at System.Console.HandlePosixSignal(PosixSignalContext ctx)
   at System.Runtime.InteropServices.PosixSignalRegistration.HandlerRoutine(Int32 dwCtrlType)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 11:54:32.190 +08:00 [INF] Cleaning up resources...
2025-03-27 11:54:32.191 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.SendAsyncForNetworkStream(ReadOnlyMemory`1 buffer, SocketFlags socketFlags, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_0>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 26
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_0(Object s, EventArgs e)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 11:54:34.345 +08:00 [INF] Starting RFID Server...
2025-03-27 11:54:34.382 +08:00 [INF] Connecting to WebSocket...
2025-03-27 11:54:34.429 +08:00 [INF] WebSocket connected successfully
2025-03-27 11:54:34.446 +08:00 [INF] RFID reader connected to COM3
2025-03-27 11:54:38.313 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:54:38.317 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:54:38.320 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:54:38.372 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:54:38.3219790Z"}}
2025-03-27 11:54:38.461 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:54:38.4588141Z"}}
2025-03-27 11:54:38.782 +08:00 [DBG] Received data: No card
2025-03-27 11:54:44.050 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:54:44.051 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:54:44.053 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:54:44.054 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:54:44.0539598Z"}}
2025-03-27 11:54:44.059 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:54:44.0591362Z"}}
2025-03-27 11:54:44.490 +08:00 [DBG] Received data: No card
2025-03-27 11:54:49.301 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 11:54:49.303 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 11:54:49.304 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 11:54:49.305 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T03:54:49.3051500Z"}}
2025-03-27 11:54:49.308 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T03:54:49.3081314Z"}}
2025-03-27 11:54:49.739 +08:00 [DBG] Received data: No card
2025-03-27 12:03:16.861 +08:00 [INF] Cleaning up resources...
2025-03-27 12:03:16.862 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 121
2025-03-27 12:03:16.868 +08:00 [ERR] Error during resource cleanup
System.ObjectDisposedException: The CancellationTokenSource has been disposed.
   at System.Threading.CancellationTokenSource.Cancel()
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 266
2025-03-27 12:03:25.402 +08:00 [INF] Starting RFID Server...
2025-03-27 12:03:25.439 +08:00 [INF] Connecting to WebSocket...
2025-03-27 12:03:25.488 +08:00 [INF] WebSocket connected successfully
2025-03-27 12:03:25.501 +08:00 [INF] RFID reader connected to COM3
2025-03-27 12:03:33.390 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:03:33.395 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:03:33.397 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:03:33.452 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:03:33.3987202Z"}}
2025-03-27 12:03:33.487 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B4FCBC2D","employee":{"id":10,"card_number":"B4FCBC2D","name":"d","position":"d","created_at":"2025-03-27T04:00:32.378Z"},"timestamp":"2025-03-27T04:03:33.4820171Z"}
2025-03-27 12:03:33.815 +08:00 [DBG] Received data: No card
2025-03-27 12:03:52.679 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:03:52.681 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:03:52.681 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:03:52.682 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:03:52.6820882Z"}}
2025-03-27 12:03:52.832 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B4FCBC2D","employee":{"id":10,"card_number":"B4FCBC2D","name":"d","position":"d","created_at":"2025-03-27T04:00:32.378Z"},"timestamp":"2025-03-27T04:03:52.8320470Z"}
2025-03-27 12:03:53.058 +08:00 [DBG] Received data: No card
2025-03-27 12:04:01.435 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:04:01.437 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:04:01.437 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:04:01.438 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:04:01.4382067Z"}}
2025-03-27 12:04:01.443 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B4FCBC2D","employee":{"id":10,"card_number":"B4FCBC2D","name":"d","position":"d","created_at":"2025-03-27T04:00:32.378Z"},"timestamp":"2025-03-27T04:04:01.4431231Z"}
2025-03-27 12:04:01.878 +08:00 [DBG] Received data: No card
2025-03-27 12:04:06.601 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:04:06.603 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:04:06.603 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:04:06.604 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:04:06.6040457Z"}}
2025-03-27 12:04:06.607 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B4FCBC2D","employee":{"id":10,"card_number":"B4FCBC2D","name":"d","position":"d","created_at":"2025-03-27T04:00:32.378Z"},"timestamp":"2025-03-27T04:04:06.6075010Z"}
2025-03-27 12:04:07.040 +08:00 [DBG] Received data: No card
2025-03-27 12:24:34.693 +08:00 [INF] Cleaning up resources...
2025-03-27 12:24:34.694 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 121
2025-03-27 12:24:34.700 +08:00 [ERR] Error during resource cleanup
System.ObjectDisposedException: The CancellationTokenSource has been disposed.
   at System.Threading.CancellationTokenSource.Cancel()
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 266
2025-03-27 12:27:07.279 +08:00 [INF] Starting RFID Server...
2025-03-27 12:27:07.340 +08:00 [INF] Connecting to WebSocket...
2025-03-27 12:27:07.385 +08:00 [INF] WebSocket connected successfully
2025-03-27 12:27:07.395 +08:00 [INF] RFID reader connected to COM3
2025-03-27 12:27:18.045 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:27:18.048 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:27:18.050 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:27:18.101 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:27:18.0518426Z"}}
2025-03-27 12:27:18.132 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B4FCBC2D","employee":{"id":10,"card_number":"B4FCBC2D","name":"d","position":"d","created_at":"2025-03-27T04:00:32.378Z"},"timestamp":"2025-03-27T04:27:18.1277773Z"}
2025-03-27 12:27:18.248 +08:00 [DBG] Received data: No card
2025-03-27 12:27:31.686 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:27:31.688 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:27:31.689 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:27:31.689 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:27:31.6897785Z"}}
2025-03-27 12:27:31.721 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B4FCBC2D","employee":{"id":10,"card_number":"B4FCBC2D","name":"d","position":"d","created_at":"2025-03-27T04:00:32.378Z"},"timestamp":"2025-03-27T04:27:31.7215224Z"}
2025-03-27 12:27:32.045 +08:00 [DBG] Received data: No card
2025-03-27 12:28:03.159 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:28:03.161 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:28:03.161 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:28:03.162 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:28:03.1623323Z"}}
2025-03-27 12:28:03.192 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B4FCBC2D","employee":{"id":10,"card_number":"B4FCBC2D","name":"d","position":"d","created_at":"2025-03-27T04:00:32.378Z"},"timestamp":"2025-03-27T04:28:03.1919850Z"}
2025-03-27 12:28:03.743 +08:00 [DBG] Received data: No card
2025-03-27 12:29:20.422 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:29:20.424 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:29:20.425 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:29:20.426 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:29:20.4263571Z"}}
2025-03-27 12:29:20.431 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B4FCBC2D","employee":{"id":10,"card_number":"B4FCBC2D","name":"d","position":"d","created_at":"2025-03-27T04:00:32.378Z"},"timestamp":"2025-03-27T04:29:20.4310060Z"}
2025-03-27 12:29:20.979 +08:00 [DBG] Received data: No card
2025-03-27 12:29:24.720 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 12:29:24.721 +08:00 [INF] Card detected: B5DAE224
2025-03-27 12:29:24.722 +08:00 [INF] Processing card: B5DAE224
2025-03-27 12:29:24.723 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224","timestamp":"2025-03-27T04:29:24.7230759Z"}}
2025-03-27 12:29:24.758 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B5DAE224","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:29:24.7563910Z"}}
2025-03-27 12:29:25.188 +08:00 [DBG] Received data: No card
2025-03-27 12:29:33.454 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:29:33.456 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:29:33.457 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:29:33.458 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:29:33.4578666Z"}}
2025-03-27 12:29:33.461 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:29:33.4615110Z"}}
2025-03-27 12:29:33.784 +08:00 [DBG] Received data: No card
2025-03-27 12:35:08.549 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:35:08.551 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:35:08.552 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:35:08.552 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:35:08.5525819Z"}}
2025-03-27 12:35:08.583 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:35:08.5833830Z"}}
2025-03-27 12:35:08.910 +08:00 [DBG] Received data: No card
2025-03-27 12:36:15.877 +08:00 [INF] Cleaning up resources...
2025-03-27 12:36:15.878 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 121
2025-03-27 12:36:15.887 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_1>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 32
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_1(Object sender, ConsoleCancelEventArgs e)
   at System.Console.HandlePosixSignal(PosixSignalContext ctx)
   at System.Runtime.InteropServices.PosixSignalRegistration.HandlerRoutine(Int32 dwCtrlType)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 12:36:15.894 +08:00 [INF] Cleaning up resources...
2025-03-27 12:36:15.896 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_0>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 26
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_0(Object s, EventArgs e)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 12:42:45.475 +08:00 [INF] Starting RFID Server...
2025-03-27 12:42:45.512 +08:00 [INF] Connecting to WebSocket...
2025-03-27 12:42:47.076 +08:00 [INF] WebSocket connected successfully
2025-03-27 12:42:47.092 +08:00 [INF] RFID reader connected to COM3
2025-03-27 12:43:03.562 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:43:03.565 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:43:03.567 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:43:03.622 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:43:03.5692069Z"}}
2025-03-27 12:43:03.681 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:43:03.6793384Z"}}
2025-03-27 12:43:03.785 +08:00 [DBG] Received data: No card
2025-03-27 12:43:11.835 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:43:11.836 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:43:11.837 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:43:11.838 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:43:11.8378665Z"}}
2025-03-27 12:43:11.841 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:43:11.8418086Z"}}
2025-03-27 12:43:12.277 +08:00 [DBG] Received data: No card
2025-03-27 12:45:12.172 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:45:12.174 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:45:12.174 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:45:12.175 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:45:12.1756545Z"}}
2025-03-27 12:45:12.207 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:45:12.2075159Z"}}
2025-03-27 12:45:12.531 +08:00 [DBG] Received data: No card
2025-03-27 12:45:16.930 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:45:16.932 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:45:16.933 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:45:16.934 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:45:16.9338871Z"}}
2025-03-27 12:45:16.937 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:45:16.9373768Z"}}
2025-03-27 12:45:17.375 +08:00 [DBG] Received data: No card
2025-03-27 12:48:27.220 +08:00 [INF] Cleaning up resources...
2025-03-27 12:48:27.221 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 121
2025-03-27 12:48:27.230 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.SendAsyncForNetworkStream(ReadOnlyMemory`1 buffer, SocketFlags socketFlags, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_1>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 32
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_1(Object sender, ConsoleCancelEventArgs e)
   at System.Console.HandlePosixSignal(PosixSignalContext ctx)
   at System.Runtime.InteropServices.PosixSignalRegistration.HandlerRoutine(Int32 dwCtrlType)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 12:48:27.238 +08:00 [INF] Cleaning up resources...
2025-03-27 12:48:27.239 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.SendAsyncForNetworkStream(ReadOnlyMemory`1 buffer, SocketFlags socketFlags, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_0>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 26
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_0(Object s, EventArgs e)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 12:48:29.808 +08:00 [INF] Starting RFID Server...
2025-03-27 12:48:29.846 +08:00 [INF] Connecting to WebSocket...
2025-03-27 12:48:29.894 +08:00 [INF] WebSocket connected successfully
2025-03-27 12:48:29.910 +08:00 [INF] RFID reader connected to COM3
2025-03-27 12:48:48.020 +08:00 [INF] Cleaning up resources...
2025-03-27 12:48:48.022 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 121
2025-03-27 12:48:48.028 +08:00 [ERR] Error during resource cleanup
System.ObjectDisposedException: The CancellationTokenSource has been disposed.
   at System.Threading.CancellationTokenSource.Cancel()
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 266
2025-03-27 12:48:50.362 +08:00 [INF] Starting RFID Server...
2025-03-27 12:48:50.400 +08:00 [INF] Connecting to WebSocket...
2025-03-27 12:48:50.446 +08:00 [INF] WebSocket connected successfully
2025-03-27 12:48:50.461 +08:00 [INF] RFID reader connected to COM3
2025-03-27 12:48:58.009 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:48:58.012 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:48:58.015 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:48:58.070 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:48:58.0160551Z"}}
2025-03-27 12:48:58.158 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:48:58.1555998Z"}}
2025-03-27 12:48:58.491 +08:00 [DBG] Received data: No card
2025-03-27 12:49:03.044 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:49:03.045 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:49:03.045 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:49:03.046 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:49:03.0462172Z"}}
2025-03-27 12:49:03.050 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:49:03.0506292Z"}}
2025-03-27 12:49:03.495 +08:00 [DBG] Received data: No card
2025-03-27 12:49:09.119 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:49:09.122 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:49:09.122 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:49:09.123 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:49:09.1233377Z"}}
2025-03-27 12:49:09.126 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:49:09.1266093Z"}}
2025-03-27 12:49:09.559 +08:00 [DBG] Received data: No card
2025-03-27 12:49:11.120 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:49:11.122 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:49:11.122 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:49:11.123 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:49:11.1231942Z"}}
2025-03-27 12:49:11.125 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:49:11.1258116Z"}}
2025-03-27 12:49:11.558 +08:00 [DBG] Received data: No card
2025-03-27 12:49:13.663 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:49:13.665 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:49:13.666 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:49:13.667 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:49:13.6669458Z"}}
2025-03-27 12:49:13.670 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:49:13.6700304Z"}}
2025-03-27 12:49:14.102 +08:00 [DBG] Received data: No card
2025-03-27 12:54:22.455 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:54:22.457 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:54:22.457 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:54:22.460 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 12:54:23.466 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 12:54:25.478 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 12:54:28.525 +08:00 [WRN] WebSocket connection closed, will reconnect
2025-03-27 12:54:29.092 +08:00 [INF] Cleaning up resources...
2025-03-27 12:54:29.094 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_1>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 32
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_1(Object sender, ConsoleCancelEventArgs e)
   at System.Console.HandlePosixSignal(PosixSignalContext ctx)
   at System.Runtime.InteropServices.PosixSignalRegistration.HandlerRoutine(Int32 dwCtrlType)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 12:54:29.102 +08:00 [INF] Cleaning up resources...
2025-03-27 12:54:29.103 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_0>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 26
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_0(Object s, EventArgs e)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 12:54:31.437 +08:00 [INF] Starting RFID Server...
2025-03-27 12:54:31.473 +08:00 [INF] Connecting to WebSocket...
2025-03-27 12:54:31.517 +08:00 [INF] WebSocket connected successfully
2025-03-27 12:54:31.531 +08:00 [INF] RFID reader connected to COM3
2025-03-27 12:54:47.131 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:54:47.135 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:54:47.138 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:54:47.185 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:54:47.1393140Z"}}
2025-03-27 12:54:47.271 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:54:47.2688188Z"}}
2025-03-27 12:54:47.595 +08:00 [DBG] Received data: No card
2025-03-27 12:54:57.404 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:54:57.406 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:54:57.407 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:54:57.408 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:54:57.4081507Z"}}
2025-03-27 12:54:57.439 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:54:57.4396707Z"}}
2025-03-27 12:54:57.878 +08:00 [DBG] Received data: No card
2025-03-27 12:55:04.909 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:55:04.911 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:55:04.911 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:55:04.912 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:55:04.9121993Z"}}
2025-03-27 12:55:04.915 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:55:04.9154199Z"}}
2025-03-27 12:55:05.350 +08:00 [DBG] Received data: No card
2025-03-27 12:55:10.551 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:55:10.553 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:55:10.553 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:55:10.554 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:55:10.5544250Z"}}
2025-03-27 12:55:10.557 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:55:10.5578005Z"}}
2025-03-27 12:55:10.903 +08:00 [DBG] Received data: No card
2025-03-27 12:55:16.494 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:55:16.496 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:55:16.496 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:55:16.497 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:55:16.4973923Z"}}
2025-03-27 12:55:16.501 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:55:16.5012205Z"}}
2025-03-27 12:55:16.822 +08:00 [DBG] Received data: No card
2025-03-27 12:55:24.412 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:55:24.414 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:55:24.414 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:55:24.415 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:55:24.4153635Z"}}
2025-03-27 12:55:24.418 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:55:24.4186351Z"}}
2025-03-27 12:55:24.742 +08:00 [DBG] Received data: No card
2025-03-27 12:55:25.409 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:55:25.411 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:55:25.411 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:55:25.412 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:55:25.4121237Z"}}
2025-03-27 12:55:25.414 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:55:25.4147552Z"}}
2025-03-27 12:55:25.739 +08:00 [DBG] Received data: No card
2025-03-27 12:55:26.293 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:55:26.295 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:55:26.295 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:55:26.296 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:55:26.2962634Z"}}
2025-03-27 12:55:26.298 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:55:26.2987597Z"}}
2025-03-27 12:55:26.627 +08:00 [DBG] Received data: No card
2025-03-27 12:55:27.184 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:55:27.186 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:55:27.187 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:55:27.187 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:55:27.1877475Z"}}
2025-03-27 12:55:27.190 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:55:27.1901079Z"}}
2025-03-27 12:55:27.628 +08:00 [DBG] Received data: No card
2025-03-27 12:55:28.287 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:55:28.289 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:55:28.289 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:55:28.290 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:55:28.2904379Z"}}
2025-03-27 12:55:28.293 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:55:28.2933404Z"}}
2025-03-27 12:55:28.622 +08:00 [DBG] Received data: No card
2025-03-27 12:55:29.173 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:55:29.175 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:55:29.176 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:55:29.176 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:55:29.1765202Z"}}
2025-03-27 12:55:29.179 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:55:29.1798160Z"}}
2025-03-27 12:55:29.505 +08:00 [DBG] Received data: No card
2025-03-27 12:55:29.967 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:55:29.968 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:55:29.969 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:55:29.970 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:55:29.9699065Z"}}
2025-03-27 12:55:29.971 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:55:29.9719146Z"}}
2025-03-27 12:55:30.404 +08:00 [DBG] Received data: No card
2025-03-27 12:55:30.863 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:55:30.864 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:55:30.865 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:55:30.866 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:55:30.8658885Z"}}
2025-03-27 12:55:30.868 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:55:30.8686265Z"}}
2025-03-27 12:55:31.087 +08:00 [DBG] Received data: No card
2025-03-27 12:55:31.774 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:55:31.776 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:55:31.777 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:55:31.777 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:55:31.7776853Z"}}
2025-03-27 12:55:31.780 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:55:31.7803052Z"}}
2025-03-27 12:55:31.998 +08:00 [DBG] Received data: No card
2025-03-27 12:56:24.131 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:56:24.133 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:56:24.134 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:56:24.135 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:56:24.1349205Z"}}
2025-03-27 12:56:24.138 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:56:24.1380707Z"}}
2025-03-27 12:56:24.459 +08:00 [DBG] Received data: No card
2025-03-27 12:58:07.581 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:58:07.583 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:58:07.583 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:58:07.584 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:58:07.5839884Z"}}
2025-03-27 12:58:07.616 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:58:07.6159067Z"}}
2025-03-27 12:58:07.945 +08:00 [DBG] Received data: No card
2025-03-27 12:58:20.049 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:58:20.051 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:58:20.052 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:58:20.053 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:58:20.0532163Z"}}
2025-03-27 12:58:20.082 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:58:20.0827857Z"}}
2025-03-27 12:58:20.409 +08:00 [DBG] Received data: No card
2025-03-27 12:59:55.201 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:59:55.202 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:59:55.203 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:59:55.203 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:59:55.2037109Z"}}
2025-03-27 12:59:55.207 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:59:55.2074580Z"}}
2025-03-27 12:59:55.641 +08:00 [DBG] Received data: No card
2025-03-27 12:59:57.062 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 12:59:57.064 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 12:59:57.064 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 12:59:57.065 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T04:59:57.0652919Z"}}
2025-03-27 12:59:57.067 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T04:59:57.0676653Z"}}
2025-03-27 12:59:57.391 +08:00 [DBG] Received data: No card
2025-03-27 13:00:02.678 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 13:00:02.680 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 13:00:02.680 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 13:00:02.681 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T05:00:02.6813598Z"}}
2025-03-27 13:00:02.684 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T05:00:02.6847124Z"}}
2025-03-27 13:00:02.899 +08:00 [DBG] Received data: No card
2025-03-27 13:01:33.655 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 13:01:33.657 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 13:01:33.657 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 13:01:33.658 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T05:01:33.6580226Z"}}
2025-03-27 13:01:33.691 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T05:01:33.6911261Z"}}
2025-03-27 13:01:34.130 +08:00 [DBG] Received data: No card
2025-03-27 13:02:24.260 +08:00 [INF] Cleaning up resources...
2025-03-27 13:02:24.261 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 121
2025-03-27 13:02:24.271 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_1>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 32
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_1(Object sender, ConsoleCancelEventArgs e)
   at System.Console.HandlePosixSignal(PosixSignalContext ctx)
   at System.Runtime.InteropServices.PosixSignalRegistration.HandlerRoutine(Int32 dwCtrlType)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 13:02:24.278 +08:00 [INF] Cleaning up resources...
2025-03-27 13:02:24.279 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_0>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 26
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_0(Object s, EventArgs e)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 13:02:26.724 +08:00 [INF] Starting RFID Server...
2025-03-27 13:02:26.765 +08:00 [INF] Connecting to WebSocket...
2025-03-27 13:02:26.812 +08:00 [INF] WebSocket connected successfully
2025-03-27 13:02:26.836 +08:00 [INF] RFID reader connected to COM3
2025-03-27 13:02:43.049 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 13:02:43.052 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 13:02:43.055 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 13:02:43.102 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T05:02:43.0563475Z"}}
2025-03-27 13:02:43.160 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T05:02:43.1579539Z"}}
2025-03-27 13:02:43.600 +08:00 [DBG] Received data: No card
2025-03-27 13:02:48.238 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 13:02:48.240 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 13:02:48.240 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 13:02:48.241 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T05:02:48.2415285Z"}}
2025-03-27 13:02:48.245 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T05:02:48.2456963Z"}}
2025-03-27 13:02:48.583 +08:00 [DBG] Received data: No card
2025-03-27 13:02:51.219 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 13:02:51.221 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 13:02:51.221 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 13:02:51.222 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T05:02:51.2223412Z"}}
2025-03-27 13:02:51.225 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T05:02:51.2250148Z"}}
2025-03-27 13:02:51.549 +08:00 [DBG] Received data: No card
2025-03-27 13:11:04.077 +08:00 [INF] Cleaning up resources...
2025-03-27 13:11:04.077 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 121
2025-03-27 13:11:04.088 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.SendAsyncForNetworkStream(ReadOnlyMemory`1 buffer, SocketFlags socketFlags, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_1>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 32
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_1(Object sender, ConsoleCancelEventArgs e)
   at System.Console.HandlePosixSignal(PosixSignalContext ctx)
   at System.Runtime.InteropServices.PosixSignalRegistration.HandlerRoutine(Int32 dwCtrlType)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 13:11:04.095 +08:00 [INF] Cleaning up resources...
2025-03-27 13:11:04.096 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.SendAsyncForNetworkStream(ReadOnlyMemory`1 buffer, SocketFlags socketFlags, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_0>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 26
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_0(Object s, EventArgs e)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 13:11:06.159 +08:00 [INF] Starting RFID Server...
2025-03-27 13:11:06.196 +08:00 [INF] Connecting to WebSocket...
2025-03-27 13:11:06.243 +08:00 [INF] WebSocket connected successfully
2025-03-27 13:11:06.266 +08:00 [INF] RFID reader connected to COM3
2025-03-27 13:11:12.451 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 13:11:12.454 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 13:11:12.457 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 13:11:12.505 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T05:11:12.4585503Z"}}
2025-03-27 13:11:12.599 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T05:11:12.5971337Z"}}
2025-03-27 13:11:12.922 +08:00 [DBG] Received data: No card
2025-03-27 13:11:21.033 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 13:11:21.035 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 13:11:21.036 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 13:11:21.037 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T05:11:21.0371497Z"}}
2025-03-27 13:11:21.042 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T05:11:21.0426677Z"}}
2025-03-27 13:11:21.491 +08:00 [DBG] Received data: No card
2025-03-27 13:11:25.885 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 13:11:25.887 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 13:11:25.888 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 13:11:25.888 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T05:11:25.8887767Z"}}
2025-03-27 13:11:25.892 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T05:11:25.8922895Z"}}
2025-03-27 13:11:26.330 +08:00 [DBG] Received data: No card
2025-03-27 13:11:31.846 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 13:11:31.848 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 13:11:31.848 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 13:11:31.849 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T05:11:31.8493871Z"}}
2025-03-27 13:11:31.853 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T05:11:31.8530359Z"}}
2025-03-27 13:11:32.302 +08:00 [DBG] Received data: No card
2025-03-27 13:12:31.778 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 13:12:31.780 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 13:12:31.780 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 13:12:31.781 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T05:12:31.7811766Z"}}
2025-03-27 13:12:31.812 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T05:12:31.8124942Z"}}
2025-03-27 13:12:32.251 +08:00 [DBG] Received data: No card
2025-03-27 13:12:54.271 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 13:12:54.273 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 13:12:54.273 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 13:12:54.274 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T05:12:54.2743347Z"}}
2025-03-27 13:12:54.304 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T05:12:54.3040885Z"}}
2025-03-27 13:12:54.740 +08:00 [DBG] Received data: No card
2025-03-27 13:14:00.599 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 13:14:00.601 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 13:14:00.603 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 13:14:00.604 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T05:14:00.6033644Z"}}
2025-03-27 13:14:00.635 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T05:14:00.6348377Z"}}
2025-03-27 13:14:00.965 +08:00 [DBG] Received data: No card
2025-03-27 13:22:08.086 +08:00 [INF] Cleaning up resources...
2025-03-27 13:22:08.086 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 121
2025-03-27 13:22:08.092 +08:00 [ERR] Error during resource cleanup
System.ObjectDisposedException: The CancellationTokenSource has been disposed.
   at System.Threading.CancellationTokenSource.Cancel()
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 266
2025-03-27 14:21:19.287 +08:00 [INF] Starting RFID Server...
2025-03-27 14:21:19.339 +08:00 [INF] Connecting to WebSocket...
2025-03-27 14:21:23.465 +08:00 [ERR] WebSocket connection failed
System.Net.WebSockets.WebSocketException (0x80004005): Unable to connect to the remote server
 ---> System.Net.Http.HttpRequestException: Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение. (localhost:3000)
 ---> System.Net.Sockets.SocketException (10061): Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectToTcpHostAsync(String host, Int32 port, HttpRequestMessage initialRequest, Boolean async, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.HttpConnectionPool.ConnectToTcpHostAsync(String host, Int32 port, HttpRequestMessage initialRequest, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.InjectNewHttp11ConnectionAsync(QueueItem queueItem)
   at System.Threading.Tasks.TaskCompletionSourceWithCancellation`1.WaitWithCancellationAsync(CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithVersionDetectionAndRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.WebSockets.WebSocketHandle.ConnectAsync(Uri uri, HttpMessageInvoker invoker, CancellationToken cancellationToken, ClientWebSocketOptions options)
   at System.Net.WebSockets.WebSocketHandle.ConnectAsync(Uri uri, HttpMessageInvoker invoker, CancellationToken cancellationToken, ClientWebSocketOptions options)
   at System.Net.WebSockets.ClientWebSocket.ConnectAsyncCore(Uri uri, HttpMessageInvoker invoker, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.InitializeWebSocket() in G:\Prog\TimeBook\Program.cs:line 89
2025-03-27 14:21:28.491 +08:00 [INF] Connecting to WebSocket...
2025-03-27 14:21:28.499 +08:00 [INF] WebSocket connected successfully
2025-03-27 14:21:28.524 +08:00 [INF] RFID reader connected to COM3
2025-03-27 14:23:29.418 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 14:23:29.420 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 14:23:29.871 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 14:23:29.923 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T06:23:29.8742794Z"}}
2025-03-27 14:23:30.008 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T06:23:30.0066118Z"}}
2025-03-27 14:23:30.123 +08:00 [DBG] Received data: No card
2025-03-27 14:23:36.070 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 14:23:36.071 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 14:23:36.072 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 14:23:36.072 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T06:23:36.0726295Z"}}
2025-03-27 14:23:36.077 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T06:23:36.0775005Z"}}
2025-03-27 14:23:36.522 +08:00 [DBG] Received data: No card
2025-03-27 14:23:58.237 +08:00 [INF] Cleaning up resources...
2025-03-27 14:23:58.237 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 122
2025-03-27 14:23:58.244 +08:00 [ERR] Error during resource cleanup
System.ObjectDisposedException: The CancellationTokenSource has been disposed.
   at System.Threading.CancellationTokenSource.Cancel()
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 269
2025-03-27 14:24:00.948 +08:00 [INF] Starting RFID Server...
2025-03-27 14:24:00.984 +08:00 [INF] Connecting to WebSocket...
2025-03-27 14:24:01.028 +08:00 [INF] WebSocket connected successfully
2025-03-27 14:24:01.052 +08:00 [INF] RFID reader connected to COM3
2025-03-27 14:24:04.789 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 14:24:04.793 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 14:24:04.795 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 14:24:04.845 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T06:24:04.7970468Z"}}
2025-03-27 14:24:04.932 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T06:24:04.9299873Z"}}
2025-03-27 14:24:05.048 +08:00 [DBG] Received data: No card
2025-03-27 14:24:11.548 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 14:24:11.550 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 14:24:11.550 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 14:24:11.551 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T06:24:11.5513363Z"}}
2025-03-27 14:24:11.555 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T06:24:11.5556925Z"}}
2025-03-27 14:24:12.102 +08:00 [DBG] Received data: No card
2025-03-27 14:24:14.754 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 14:24:14.756 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 14:24:14.756 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 14:24:14.757 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T06:24:14.7572757Z"}}
2025-03-27 14:24:14.760 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T06:24:14.7605078Z"}}
2025-03-27 14:24:15.209 +08:00 [DBG] Received data: No card
2025-03-27 14:24:19.059 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 14:24:19.060 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 14:24:19.061 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 14:24:19.062 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T06:24:19.0624711Z"}}
2025-03-27 14:24:19.065 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T06:24:19.0655790Z"}}
2025-03-27 14:24:19.500 +08:00 [DBG] Received data: No card
2025-03-27 14:24:21.047 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 14:24:21.049 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 14:24:21.050 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 14:24:21.051 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T06:24:21.0514630Z"}}
2025-03-27 14:24:21.054 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T06:24:21.0541061Z"}}
2025-03-27 14:24:21.490 +08:00 [DBG] Received data: No card
2025-03-27 14:50:01.308 +08:00 [INF] Cleaning up resources...
2025-03-27 14:50:01.309 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 122
2025-03-27 14:50:01.316 +08:00 [ERR] Error during resource cleanup
System.ObjectDisposedException: The CancellationTokenSource has been disposed.
   at System.Threading.CancellationTokenSource.Cancel()
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 269
2025-03-27 14:51:06.040 +08:00 [INF] Starting RFID Server...
2025-03-27 14:51:06.102 +08:00 [INF] Connecting to WebSocket...
2025-03-27 14:51:10.198 +08:00 [ERR] WebSocket connection failed
System.Net.WebSockets.WebSocketException (0x80004005): Unable to connect to the remote server
 ---> System.Net.Http.HttpRequestException: Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение. (localhost:3000)
 ---> System.Net.Sockets.SocketException (10061): Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectToTcpHostAsync(String host, Int32 port, HttpRequestMessage initialRequest, Boolean async, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.HttpConnectionPool.ConnectToTcpHostAsync(String host, Int32 port, HttpRequestMessage initialRequest, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.InjectNewHttp11ConnectionAsync(QueueItem queueItem)
   at System.Threading.Tasks.TaskCompletionSourceWithCancellation`1.WaitWithCancellationAsync(CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithVersionDetectionAndRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.WebSockets.WebSocketHandle.ConnectAsync(Uri uri, HttpMessageInvoker invoker, CancellationToken cancellationToken, ClientWebSocketOptions options)
   at System.Net.WebSockets.WebSocketHandle.ConnectAsync(Uri uri, HttpMessageInvoker invoker, CancellationToken cancellationToken, ClientWebSocketOptions options)
   at System.Net.WebSockets.ClientWebSocket.ConnectAsyncCore(Uri uri, HttpMessageInvoker invoker, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.InitializeWebSocket() in G:\Prog\TimeBook\Program.cs:line 89
2025-03-27 14:51:10.324 +08:00 [INF] Cleaning up resources...
2025-03-27 14:51:10.324 +08:00 [FTL] Critical error occurred
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.InitializeWebSocket() in G:\Prog\TimeBook\Program.cs:line 96
   at Z2M_Mifare.Program.Main(String[] args) in G:\Prog\TimeBook\Program.cs:line 41
2025-03-27 14:51:10.326 +08:00 [ERR] Error during resource cleanup
System.ObjectDisposedException: The CancellationTokenSource has been disposed.
   at System.Threading.CancellationTokenSource.Cancel()
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 272
2025-03-27 14:51:17.647 +08:00 [INF] Starting RFID Server...
2025-03-27 14:51:17.683 +08:00 [INF] Connecting to WebSocket...
2025-03-27 14:51:17.730 +08:00 [INF] WebSocket connected successfully
2025-03-27 14:51:17.755 +08:00 [INF] RFID reader connected to COM3
2025-03-27 14:51:49.657 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 14:51:49.660 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 14:51:49.663 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 14:51:49.708 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T06:51:49.6636198Z"}}
2025-03-27 14:51:49.759 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T06:51:49.7577142Z"}}
2025-03-27 14:51:50.090 +08:00 [DBG] Received data: No card
2025-03-27 14:52:17.630 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 14:52:17.632 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 14:52:17.632 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 14:52:17.633 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T06:52:17.6332944Z"}}
2025-03-27 14:52:17.665 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T06:52:17.6654523Z"}}
2025-03-27 14:52:18.107 +08:00 [DBG] Received data: No card
2025-03-27 14:54:17.318 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 14:54:17.320 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 14:54:17.321 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 14:54:17.321 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T06:54:17.3216746Z"}}
2025-03-27 14:54:17.354 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T06:54:17.3543801Z"}}
2025-03-27 14:54:17.678 +08:00 [DBG] Received data: No card
2025-03-27 14:59:27.781 +08:00 [INF] Cleaning up resources...
2025-03-27 14:59:27.783 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 122
2025-03-27 14:59:27.791 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.SendAsyncForNetworkStream(ReadOnlyMemory`1 buffer, SocketFlags socketFlags, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 279
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_1>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 33
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_1(Object sender, ConsoleCancelEventArgs e)
   at System.Console.HandlePosixSignal(PosixSignalContext ctx)
   at System.Runtime.InteropServices.PosixSignalRegistration.HandlerRoutine(Int32 dwCtrlType)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 279
2025-03-27 14:59:27.799 +08:00 [INF] Cleaning up resources...
2025-03-27 14:59:27.800 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.SendAsyncForNetworkStream(ReadOnlyMemory`1 buffer, SocketFlags socketFlags, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 279
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_0>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 27
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_0(Object s, EventArgs e)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 279
2025-03-27 14:59:35.707 +08:00 [INF] Starting RFID Server...
2025-03-27 14:59:35.744 +08:00 [INF] Connecting to WebSocket...
2025-03-27 14:59:35.789 +08:00 [INF] WebSocket connected successfully
2025-03-27 14:59:35.799 +08:00 [INF] RFID reader connected to COM3
2025-03-27 15:01:01.309 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 15:01:01.313 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 15:01:01.315 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 15:01:01.362 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T07:01:01.3163760Z"}}
2025-03-27 15:01:01.407 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T07:01:01.4059583Z"}}
2025-03-27 15:01:01.745 +08:00 [DBG] Received data: No card
2025-03-27 15:01:10.859 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 15:01:10.861 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 15:01:10.861 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 15:01:10.862 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T07:01:10.8621289Z"}}
2025-03-27 15:01:10.866 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T07:01:10.8664976Z"}}
2025-03-27 15:01:11.314 +08:00 [DBG] Received data: No card
2025-03-27 15:01:39.151 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 15:01:39.151 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 15:01:39.152 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 15:01:39.153 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T07:01:39.1531821Z"}}
2025-03-27 15:01:39.156 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T07:01:39.1567260Z"}}
2025-03-27 15:01:39.600 +08:00 [DBG] Received data: No card
2025-03-27 15:01:45.173 +08:00 [INF] Cleaning up resources...
2025-03-27 15:01:45.174 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 122
2025-03-27 15:01:45.180 +08:00 [ERR] Error during resource cleanup
System.ObjectDisposedException: The CancellationTokenSource has been disposed.
   at System.Threading.CancellationTokenSource.Cancel()
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 272
2025-03-27 15:01:47.567 +08:00 [INF] Starting RFID Server...
2025-03-27 15:01:47.601 +08:00 [INF] Connecting to WebSocket...
2025-03-27 15:01:47.644 +08:00 [INF] WebSocket connected successfully
2025-03-27 15:01:47.664 +08:00 [INF] RFID reader connected to COM3
2025-03-27 15:01:50.834 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 15:01:50.838 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 15:01:50.840 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 15:01:50.885 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T07:01:50.8412849Z"}}
2025-03-27 15:01:50.930 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T07:01:50.9294583Z"}}
2025-03-27 15:01:51.163 +08:00 [DBG] Received data: No card
2025-03-27 15:01:58.988 +08:00 [INF] Cleaning up resources...
2025-03-27 15:01:58.990 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 122
2025-03-27 15:01:58.999 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.SendAsyncForNetworkStream(ReadOnlyMemory`1 buffer, SocketFlags socketFlags, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 279
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_1>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 33
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_1(Object sender, ConsoleCancelEventArgs e)
   at System.Console.HandlePosixSignal(PosixSignalContext ctx)
   at System.Runtime.InteropServices.PosixSignalRegistration.HandlerRoutine(Int32 dwCtrlType)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 279
2025-03-27 15:01:59.006 +08:00 [INF] Cleaning up resources...
2025-03-27 15:01:59.007 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.SendAsyncForNetworkStream(ReadOnlyMemory`1 buffer, SocketFlags socketFlags, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 279
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_0>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 27
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_0(Object s, EventArgs e)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 279
2025-03-27 15:02:01.206 +08:00 [INF] Starting RFID Server...
2025-03-27 15:02:01.241 +08:00 [INF] Connecting to WebSocket...
2025-03-27 15:02:01.288 +08:00 [INF] WebSocket connected successfully
2025-03-27 15:02:01.305 +08:00 [INF] RFID reader connected to COM3
2025-03-27 15:02:04.052 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 15:02:04.057 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 15:02:04.059 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 15:02:04.113 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T07:02:04.0598841Z"}}
2025-03-27 15:02:04.138 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T07:02:04.1368759Z"}}
2025-03-27 15:02:04.475 +08:00 [DBG] Received data: No card
2025-03-27 15:02:20.192 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 15:02:20.193 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 15:02:20.194 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 15:02:20.195 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T07:02:20.1948848Z"}}
2025-03-27 15:02:20.198 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T07:02:20.1988174Z"}}
2025-03-27 15:02:20.523 +08:00 [DBG] Received data: No card
2025-03-27 15:02:24.044 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 15:02:24.046 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 15:02:24.047 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 15:02:24.048 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T07:02:24.0484339Z"}}
2025-03-27 15:02:24.051 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована","timestamp":"2025-03-27T07:02:24.0512225Z"}}
2025-03-27 15:02:24.487 +08:00 [DBG] Received data: No card
2025-03-27 15:02:54.745 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 15:02:54.748 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 15:02:54.749 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 15:02:54.749 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T07:02:54.7496201Z"}}
2025-03-27 15:02:54.796 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B4FCBC2D","employee":{"id":11,"card_number":"B4FCBC2D","name":"’Ґбв®ўл© ‘®ваг¤­ЁЄ","position":"’Ґбв®ў п ¤®«¦­®бвм","created_at":"2025-03-27T07:02:38.945Z"},"timestamp":"2025-03-27T07:02:54.7912362Z"}
2025-03-27 15:02:55.168 +08:00 [DBG] Received data: No card
2025-03-27 15:03:14.199 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 15:03:14.200 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 15:03:14.200 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 15:03:14.201 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T07:03:14.2014045Z"}}
2025-03-27 15:03:14.235 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B4FCBC2D","employee":{"id":11,"card_number":"B4FCBC2D","name":"’Ґбв®ўл© ‘®ваг¤­ЁЄ","position":"’Ґбв®ў п ¤®«¦­®бвм","created_at":"2025-03-27T07:02:38.945Z"},"timestamp":"2025-03-27T07:03:14.2349314Z"}
2025-03-27 15:03:14.252 +08:00 [ERR] Checkin failed: {"error":"столбец \"notes\" в таблице \"checkins\" не существует"}
2025-03-27 15:03:14.598 +08:00 [DBG] Received data: No card
2025-03-27 15:04:42.364 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 15:04:42.365 +08:00 [INF] Card detected: B5DAE224
2025-03-27 15:04:42.366 +08:00 [INF] Processing card: B5DAE224
2025-03-27 15:04:42.367 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224","timestamp":"2025-03-27T07:04:42.3671395Z"}}
2025-03-27 15:04:42.397 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B5DAE224","error":"Карта не зарегистрирована","timestamp":"2025-03-27T07:04:42.3975688Z"}}
2025-03-27 15:04:42.728 +08:00 [DBG] Received data: No card
2025-03-27 15:04:47.323 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 15:04:47.325 +08:00 [INF] Card detected: B5DAE224
2025-03-27 15:04:47.325 +08:00 [INF] Processing card: B5DAE224
2025-03-27 15:04:47.326 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224","timestamp":"2025-03-27T07:04:47.3261434Z"}}
2025-03-27 15:04:47.329 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B5DAE224","error":"Карта не зарегистрирована","timestamp":"2025-03-27T07:04:47.3293522Z"}}
2025-03-27 15:04:47.763 +08:00 [DBG] Received data: No card
2025-03-27 15:04:53.837 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 15:04:53.839 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 15:04:53.840 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 15:04:53.841 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D","timestamp":"2025-03-27T07:04:53.8409855Z"}}
2025-03-27 15:04:53.844 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B4FCBC2D","employee":{"id":11,"card_number":"B4FCBC2D","name":"’Ґбв®ўл© ‘®ваг¤­ЁЄ","position":"’Ґбв®ў п ¤®«¦­®бвм","created_at":"2025-03-27T07:02:38.945Z"},"timestamp":"2025-03-27T07:04:53.8446489Z"}
2025-03-27 15:04:53.859 +08:00 [ERR] Checkin failed: {"error":"столбец \"notes\" в таблице \"checkins\" не существует"}
2025-03-27 15:04:54.191 +08:00 [DBG] Received data: No card
2025-03-27 15:11:29.029 +08:00 [INF] Cleaning up resources...
2025-03-27 15:11:29.030 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 122
2025-03-27 15:11:29.039 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 279
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_1>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 33
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_1(Object sender, ConsoleCancelEventArgs e)
   at System.Console.HandlePosixSignal(PosixSignalContext ctx)
   at System.Runtime.InteropServices.PosixSignalRegistration.HandlerRoutine(Int32 dwCtrlType)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 279
2025-03-27 15:11:29.045 +08:00 [INF] Cleaning up resources...
2025-03-27 15:11:29.046 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 279
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_0>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 27
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_0(Object s, EventArgs e)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 279
2025-03-27 15:11:40.551 +08:00 [INF] Starting RFID Server...
2025-03-27 15:11:40.603 +08:00 [INF] Connecting to WebSocket...
2025-03-27 15:11:40.650 +08:00 [INF] WebSocket connected successfully
2025-03-27 15:11:40.665 +08:00 [INF] RFID reader connected to COM3
2025-03-27 15:12:40.493 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 15:12:40.496 +08:00 [INF] Card detected: B5DAE224
2025-03-27 15:12:40.499 +08:00 [INF] Processing card: B5DAE224
2025-03-27 15:12:40.553 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 15:12:40.920 +08:00 [DBG] Received data: No card
2025-03-27 15:13:07.648 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 15:13:07.650 +08:00 [INF] Card detected: B5DAE224
2025-03-27 15:13:07.651 +08:00 [INF] Processing card: B5DAE224
2025-03-27 15:13:07.652 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 15:13:08.098 +08:00 [DBG] Received data: No card
2025-03-27 15:13:20.832 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 15:13:20.834 +08:00 [INF] Card detected: B5DAE224
2025-03-27 15:13:20.835 +08:00 [INF] Processing card: B5DAE224
2025-03-27 15:13:20.835 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 15:13:21.192 +08:00 [DBG] Received data: No card
2025-03-27 15:14:15.604 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 15:14:15.605 +08:00 [INF] Card detected: B5DAE224
2025-03-27 15:14:15.607 +08:00 [INF] Processing card: B5DAE224
2025-03-27 15:14:15.607 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 15:14:15.965 +08:00 [DBG] Received data: No card
2025-03-27 15:14:18.729 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 15:14:18.731 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 15:14:18.731 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 15:14:18.732 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D"}}
2025-03-27 15:14:19.060 +08:00 [DBG] Received data: No card
2025-03-27 15:14:23.566 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 15:14:23.568 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 15:14:23.568 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 15:14:23.569 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D"}}
2025-03-27 15:14:23.905 +08:00 [DBG] Received data: No card
2025-03-27 15:14:25.264 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 15:14:25.266 +08:00 [INF] Card detected: B5DAE224
2025-03-27 15:14:25.267 +08:00 [INF] Processing card: B5DAE224
2025-03-27 15:14:25.267 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 15:14:25.601 +08:00 [DBG] Received data: No card
2025-03-27 15:19:26.332 +08:00 [INF] Cleaning up resources...
2025-03-27 15:19:26.334 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 122
2025-03-27 15:19:26.343 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.SendAsyncForNetworkStream(ReadOnlyMemory`1 buffer, SocketFlags socketFlags, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 266
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_1>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 33
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_1(Object sender, ConsoleCancelEventArgs e)
   at System.Console.HandlePosixSignal(PosixSignalContext ctx)
   at System.Runtime.InteropServices.PosixSignalRegistration.HandlerRoutine(Int32 dwCtrlType)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 266
2025-03-27 15:19:26.349 +08:00 [INF] Cleaning up resources...
2025-03-27 15:19:26.350 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.SendAsyncForNetworkStream(ReadOnlyMemory`1 buffer, SocketFlags socketFlags, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 266
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_0>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 27
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_0(Object s, EventArgs e)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 266
2025-03-27 15:19:37.927 +08:00 [INF] Starting RFID Server...
2025-03-27 15:19:37.978 +08:00 [INF] Connecting to WebSocket...
2025-03-27 15:19:38.023 +08:00 [INF] WebSocket connected successfully
2025-03-27 15:19:38.037 +08:00 [INF] RFID reader connected to COM3
2025-03-27 15:19:47.349 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 15:19:47.353 +08:00 [INF] Card detected: B5DAE224
2025-03-27 15:19:47.356 +08:00 [INF] Processing card: B5DAE224
2025-03-27 15:19:47.406 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 15:19:47.422 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B5DAE224","error":"Карта не зарегистрирована"}}
2025-03-27 15:19:47.755 +08:00 [DBG] Received data: No card
2025-03-27 15:19:53.735 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 15:19:53.736 +08:00 [INF] Card detected: B5DAE224
2025-03-27 15:19:53.737 +08:00 [INF] Processing card: B5DAE224
2025-03-27 15:19:53.738 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 15:19:53.743 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B5DAE224","error":"Карта не зарегистрирована"}}
2025-03-27 15:19:53.978 +08:00 [DBG] Received data: No card
2025-03-27 15:21:16.120 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 15:21:16.122 +08:00 [INF] Card detected: B5DAE224
2025-03-27 15:21:16.122 +08:00 [INF] Processing card: B5DAE224
2025-03-27 15:21:16.123 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 15:21:16.174 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"’Ґбв®ўл© ‘®ваг¤­ЁЄ","position":"’Ґбв®ў п ¤®«¦­®бвм","created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 15:21:16.566 +08:00 [DBG] Received data: No card
2025-03-27 15:21:28.956 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 15:21:28.957 +08:00 [INF] Card detected: B5DAE224
2025-03-27 15:21:28.958 +08:00 [INF] Processing card: B5DAE224
2025-03-27 15:21:28.959 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 15:21:28.962 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"’Ґбв®ўл© ‘®ваг¤­ЁЄ","position":"’Ґбв®ў п ¤®«¦­®бвм","created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 15:21:29.415 +08:00 [DBG] Received data: No card
2025-03-27 15:21:31.516 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 15:21:31.518 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 15:21:31.518 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 15:21:31.519 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D"}}
2025-03-27 15:21:31.522 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована"}}
2025-03-27 15:21:31.736 +08:00 [DBG] Received data: No card
2025-03-27 15:21:35.709 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 15:21:35.711 +08:00 [INF] Card detected: B5DAE224
2025-03-27 15:21:35.712 +08:00 [INF] Processing card: B5DAE224
2025-03-27 15:21:35.712 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 15:21:35.715 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"’Ґбв®ўл© ‘®ваг¤­ЁЄ","position":"’Ґбв®ў п ¤®«¦­®бвм","created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 15:21:35.947 +08:00 [DBG] Received data: No card
2025-03-27 15:21:40.672 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 15:21:40.673 +08:00 [INF] Card detected: B5DAE224
2025-03-27 15:21:40.674 +08:00 [INF] Processing card: B5DAE224
2025-03-27 15:21:40.674 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 15:21:40.706 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"’Ґбв®ўл© ‘®ваг¤­ЁЄ","position":"’Ґбв®ў п ¤®«¦­®бвм","created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 15:21:40.940 +08:00 [DBG] Received data: No card
2025-03-27 15:22:17.247 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 15:22:17.249 +08:00 [INF] Card detected: B5DAE224
2025-03-27 15:22:17.249 +08:00 [INF] Processing card: B5DAE224
2025-03-27 15:22:17.250 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 15:22:17.282 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"’Ґбв®ўл© ‘®ваг¤­ЁЄ","position":"’Ґбв®ў п ¤®«¦­®бвм","created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 15:22:17.723 +08:00 [DBG] Received data: No card
2025-03-27 15:22:18.990 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 15:22:18.991 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 15:22:18.992 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 15:22:18.993 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D"}}
2025-03-27 15:22:19.023 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована"}}
2025-03-27 15:22:19.248 +08:00 [DBG] Received data: No card
2025-03-27 15:22:21.550 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 15:22:21.552 +08:00 [INF] Card detected: B5DAE224
2025-03-27 15:22:21.553 +08:00 [INF] Processing card: B5DAE224
2025-03-27 15:22:21.554 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 15:22:21.556 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"’Ґбв®ўл© ‘®ваг¤­ЁЄ","position":"’Ґбв®ў п ¤®«¦­®бвм","created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 15:22:21.895 +08:00 [DBG] Received data: No card
2025-03-27 15:22:28.943 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 15:22:28.945 +08:00 [INF] Card detected: B5DAE224
2025-03-27 15:22:28.946 +08:00 [INF] Processing card: B5DAE224
2025-03-27 15:22:28.947 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 15:22:28.950 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"’Ґбв®ўл© ‘®ваг¤­ЁЄ","position":"’Ґбв®ў п ¤®«¦­®бвм","created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 15:22:29.288 +08:00 [DBG] Received data: No card
2025-03-27 15:22:44.003 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 15:22:44.005 +08:00 [INF] Card detected: B5DAE224
2025-03-27 15:22:44.005 +08:00 [INF] Processing card: B5DAE224
2025-03-27 15:22:44.006 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 15:22:44.150 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"’Ґбв®ўл© ‘®ваг¤­ЁЄ","position":"’Ґбв®ў п ¤®«¦­®бвм","created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 15:22:44.270 +08:00 [DBG] Received data: No card
2025-03-27 15:22:49.426 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 15:22:49.428 +08:00 [INF] Card detected: B5DAE224
2025-03-27 15:22:49.428 +08:00 [INF] Processing card: B5DAE224
2025-03-27 15:22:49.429 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 15:22:49.458 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"’Ґбв®ўл© ‘®ваг¤­ЁЄ","position":"’Ґбв®ў п ¤®«¦­®бвм","created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 15:22:49.786 +08:00 [DBG] Received data: No card
2025-03-27 15:22:56.325 +08:00 [INF] Cleaning up resources...
2025-03-27 15:22:56.326 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 122
2025-03-27 15:22:56.335 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 269
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_1>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 33
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_1(Object sender, ConsoleCancelEventArgs e)
   at System.Console.HandlePosixSignal(PosixSignalContext ctx)
   at System.Runtime.InteropServices.PosixSignalRegistration.HandlerRoutine(Int32 dwCtrlType)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 269
2025-03-27 15:22:56.342 +08:00 [INF] Cleaning up resources...
2025-03-27 15:22:56.343 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 269
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_0>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 27
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_0(Object s, EventArgs e)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 269
2025-03-27 15:22:58.539 +08:00 [INF] Starting RFID Server...
2025-03-27 15:22:58.577 +08:00 [INF] Connecting to WebSocket...
2025-03-27 15:22:58.628 +08:00 [INF] WebSocket connected successfully
2025-03-27 15:22:58.641 +08:00 [INF] RFID reader connected to COM3
2025-03-27 15:23:02.060 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 15:23:02.063 +08:00 [INF] Card detected: B5DAE224
2025-03-27 15:23:02.065 +08:00 [INF] Processing card: B5DAE224
2025-03-27 15:23:02.111 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 15:23:02.149 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"’Ґбв®ўл© ‘®ваг¤­ЁЄ","position":"’Ґбв®ў п ¤®«¦­®бвм","created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 15:23:02.512 +08:00 [DBG] Received data: No card
2025-03-27 15:23:10.424 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 15:23:10.425 +08:00 [INF] Card detected: B5DAE224
2025-03-27 15:23:10.426 +08:00 [INF] Processing card: B5DAE224
2025-03-27 15:23:10.426 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 15:23:10.459 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"’Ґбв®ўл© ‘®ваг¤­ЁЄ","position":"’Ґбв®ў п ¤®«¦­®бвм","created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 15:23:10.807 +08:00 [DBG] Received data: No card
2025-03-27 15:23:15.449 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 15:23:15.451 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 15:23:15.451 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 15:23:15.452 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D"}}
2025-03-27 15:23:15.484 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована"}}
2025-03-27 15:23:15.912 +08:00 [DBG] Received data: No card
2025-03-27 15:23:21.652 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 15:23:21.653 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 15:23:21.654 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 15:23:21.655 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D"}}
2025-03-27 15:23:21.658 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована"}}
2025-03-27 15:23:22.096 +08:00 [DBG] Received data: No card
2025-03-27 15:23:25.729 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 15:23:25.731 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 15:23:25.731 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 15:23:25.732 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D"}}
2025-03-27 15:23:25.736 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована"}}
2025-03-27 15:23:25.950 +08:00 [DBG] Received data: No card
2025-03-27 15:23:27.425 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 15:23:27.427 +08:00 [INF] Card detected: B5DAE224
2025-03-27 15:23:27.428 +08:00 [INF] Processing card: B5DAE224
2025-03-27 15:23:27.428 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 15:23:27.431 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"’Ґбв®ўл© ‘®ваг¤­ЁЄ","position":"’Ґбв®ў п ¤®«¦­®бвм","created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 15:23:27.767 +08:00 [DBG] Received data: No card
2025-03-27 15:24:22.290 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 15:24:22.292 +08:00 [INF] Card detected: B5DAE224
2025-03-27 15:24:22.292 +08:00 [INF] Processing card: B5DAE224
2025-03-27 15:24:22.293 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 15:24:22.436 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"’Ґбв®ўл© ‘®ваг¤­ЁЄ","position":"’Ґбв®ў п ¤®«¦­®бвм","created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 15:24:22.556 +08:00 [DBG] Received data: No card
2025-03-27 15:27:13.029 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 15:27:13.031 +08:00 [INF] Card detected: B5DAE224
2025-03-27 15:27:13.031 +08:00 [INF] Processing card: B5DAE224
2025-03-27 15:27:13.032 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 15:27:13.037 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 15:27:13.487 +08:00 [DBG] Received data: No card
2025-03-27 15:27:15.113 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 15:27:15.114 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 15:27:15.115 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 15:27:15.115 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D"}}
2025-03-27 15:27:15.118 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована"}}
2025-03-27 15:27:15.558 +08:00 [DBG] Received data: No card
2025-03-27 15:32:54.796 +08:00 [INF] Cleaning up resources...
2025-03-27 15:32:54.797 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 122
2025-03-27 15:32:54.806 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 269
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_1>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 33
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_1(Object sender, ConsoleCancelEventArgs e)
   at System.Console.HandlePosixSignal(PosixSignalContext ctx)
   at System.Runtime.InteropServices.PosixSignalRegistration.HandlerRoutine(Int32 dwCtrlType)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 269
2025-03-27 15:32:54.813 +08:00 [INF] Cleaning up resources...
2025-03-27 15:32:54.814 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 269
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_0>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 27
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_0(Object s, EventArgs e)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 269
2025-03-27 16:13:04.558 +08:00 [INF] Starting RFID Server...
2025-03-27 16:13:04.622 +08:00 [INF] Connecting to WebSocket...
2025-03-27 16:13:04.669 +08:00 [INF] WebSocket connected successfully
2025-03-27 16:13:04.689 +08:00 [INF] RFID reader connected to COM3
2025-03-27 16:13:27.677 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 16:13:27.681 +08:00 [INF] Card detected: B5DAE224
2025-03-27 16:13:27.683 +08:00 [INF] Processing card: B5DAE224
2025-03-27 16:13:27.732 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 16:13:27.796 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 16:13:28.154 +08:00 [DBG] Received data: No card
2025-03-27 16:14:15.745 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-27 16:14:15.747 +08:00 [INF] Card detected: B4FCBC2D
2025-03-27 16:14:15.748 +08:00 [INF] Processing card: B4FCBC2D
2025-03-27 16:14:15.748 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D"}}
2025-03-27 16:14:15.782 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована"}}
2025-03-27 16:14:16.223 +08:00 [DBG] Received data: No card
2025-03-27 16:14:53.085 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 16:14:53.086 +08:00 [INF] Card detected: B5DAE224
2025-03-27 16:14:53.087 +08:00 [INF] Processing card: B5DAE224
2025-03-27 16:14:53.088 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 16:14:53.119 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 16:14:53.445 +08:00 [DBG] Received data: No card
2025-03-27 16:15:11.003 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 16:15:11.005 +08:00 [INF] Card detected: B5DAE224
2025-03-27 16:15:11.006 +08:00 [INF] Processing card: B5DAE224
2025-03-27 16:15:11.006 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 16:15:11.039 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 16:15:11.485 +08:00 [DBG] Received data: No card
2025-03-27 16:15:16.152 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 16:15:16.154 +08:00 [INF] Card detected: B5DAE224
2025-03-27 16:15:16.154 +08:00 [INF] Processing card: B5DAE224
2025-03-27 16:15:16.155 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 16:15:16.158 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 16:15:16.385 +08:00 [DBG] Received data: No card
2025-03-27 16:15:39.856 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 16:15:39.858 +08:00 [INF] Card detected: B5DAE224
2025-03-27 16:15:39.858 +08:00 [INF] Processing card: B5DAE224
2025-03-27 16:15:39.859 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 16:15:39.863 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 16:15:40.207 +08:00 [DBG] Received data: No card
2025-03-27 16:17:19.314 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 16:17:19.316 +08:00 [INF] Card detected: B5DAE224
2025-03-27 16:17:19.316 +08:00 [INF] Processing card: B5DAE224
2025-03-27 16:17:19.317 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 16:17:19.348 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 16:17:19.691 +08:00 [DBG] Received data: No card
2025-03-27 16:21:35.780 +08:00 [INF] Cleaning up resources...
2025-03-27 16:21:35.782 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 122
2025-03-27 16:21:35.789 +08:00 [ERR] Error during resource cleanup
System.ObjectDisposedException: The CancellationTokenSource has been disposed.
   at System.Threading.CancellationTokenSource.Cancel()
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 16:21:50.221 +08:00 [INF] Starting RFID Server...
2025-03-27 16:21:50.283 +08:00 [INF] Connecting to WebSocket...
2025-03-27 16:21:50.332 +08:00 [INF] WebSocket connected successfully
2025-03-27 16:21:50.351 +08:00 [INF] RFID reader connected to COM3
2025-03-27 16:22:00.924 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 16:22:00.927 +08:00 [INF] Card detected: B5DAE224
2025-03-27 16:22:00.930 +08:00 [INF] Processing card: B5DAE224
2025-03-27 16:22:00.974 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 16:22:01.014 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 16:22:01.381 +08:00 [DBG] Received data: No card
2025-03-27 16:22:25.404 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 16:22:25.406 +08:00 [INF] Card detected: B5DAE224
2025-03-27 16:22:25.406 +08:00 [INF] Processing card: B5DAE224
2025-03-27 16:22:25.407 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 16:22:25.438 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 16:22:25.888 +08:00 [DBG] Received data: No card
2025-03-27 16:22:31.302 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 16:22:31.304 +08:00 [INF] Card detected: B5DAE224
2025-03-27 16:22:31.304 +08:00 [INF] Processing card: B5DAE224
2025-03-27 16:22:31.305 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 16:22:31.308 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 16:22:31.754 +08:00 [DBG] Received data: No card
2025-03-27 16:22:39.171 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 16:22:39.173 +08:00 [INF] Card detected: B5DAE224
2025-03-27 16:22:39.174 +08:00 [INF] Processing card: B5DAE224
2025-03-27 16:22:39.175 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 16:22:39.178 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 16:22:39.504 +08:00 [DBG] Received data: No card
2025-03-27 16:22:41.382 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 16:22:41.383 +08:00 [INF] Card detected: B5DAE224
2025-03-27 16:22:41.384 +08:00 [INF] Processing card: B5DAE224
2025-03-27 16:22:41.385 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 16:22:41.387 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 16:22:41.838 +08:00 [DBG] Received data: No card
2025-03-27 16:23:03.615 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 16:23:03.617 +08:00 [INF] Card detected: B5DAE224
2025-03-27 16:23:03.617 +08:00 [INF] Processing card: B5DAE224
2025-03-27 16:23:03.617 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 16:23:03.621 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 16:23:04.071 +08:00 [DBG] Received data: No card
2025-03-27 16:23:31.626 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 16:23:31.628 +08:00 [INF] Card detected: B5DAE224
2025-03-27 16:23:31.629 +08:00 [INF] Processing card: B5DAE224
2025-03-27 16:23:31.630 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 16:23:31.634 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 16:23:31.973 +08:00 [DBG] Received data: No card
2025-03-27 16:24:48.563 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 16:24:48.564 +08:00 [INF] Card detected: B5DAE224
2025-03-27 16:24:48.565 +08:00 [INF] Processing card: B5DAE224
2025-03-27 16:24:48.565 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 16:24:48.598 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 16:24:48.825 +08:00 [DBG] Received data: No card
2025-03-27 16:32:13.868 +08:00 [INF] Cleaning up resources...
2025-03-27 16:32:13.870 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 122
2025-03-27 16:32:13.880 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 280
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_1>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 33
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_1(Object sender, ConsoleCancelEventArgs e)
   at System.Console.HandlePosixSignal(PosixSignalContext ctx)
   at System.Runtime.InteropServices.PosixSignalRegistration.HandlerRoutine(Int32 dwCtrlType)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 280
2025-03-27 16:32:13.891 +08:00 [INF] Cleaning up resources...
2025-03-27 16:32:13.892 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 280
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_0>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 27
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_0(Object s, EventArgs e)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 280
2025-03-27 16:37:17.392 +08:00 [INF] Starting RFID Server...
2025-03-27 16:37:17.454 +08:00 [INF] Connecting to WebSocket...
2025-03-27 16:37:17.500 +08:00 [INF] WebSocket connected successfully
2025-03-27 16:37:17.512 +08:00 [INF] RFID reader connected to COM3
2025-03-27 16:37:27.495 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 16:37:27.499 +08:00 [INF] Card detected: B5DAE224
2025-03-27 16:37:27.502 +08:00 [INF] Processing card: B5DAE224
2025-03-27 16:37:27.552 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 16:37:27.584 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 16:37:27.953 +08:00 [DBG] Received data: No card
2025-03-27 16:37:39.889 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 16:37:39.891 +08:00 [INF] Card detected: B5DAE224
2025-03-27 16:37:39.892 +08:00 [INF] Processing card: B5DAE224
2025-03-27 16:37:39.892 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 16:37:39.896 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 16:37:40.234 +08:00 [DBG] Received data: No card
2025-03-27 16:37:56.710 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 16:37:56.711 +08:00 [INF] Card detected: B5DAE224
2025-03-27 16:37:56.712 +08:00 [INF] Processing card: B5DAE224
2025-03-27 16:37:56.713 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 16:37:56.716 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 16:37:57.171 +08:00 [DBG] Received data: No card
2025-03-27 16:38:05.350 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 16:38:05.350 +08:00 [INF] Card detected: B5DAE224
2025-03-27 16:38:05.351 +08:00 [INF] Processing card: B5DAE224
2025-03-27 16:38:05.352 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 16:38:05.355 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 16:38:05.793 +08:00 [DBG] Received data: No card
2025-03-27 16:38:26.677 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 16:38:26.679 +08:00 [INF] Card detected: B5DAE224
2025-03-27 16:38:26.679 +08:00 [INF] Processing card: B5DAE224
2025-03-27 16:38:26.680 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 16:38:26.683 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 16:38:27.025 +08:00 [DBG] Received data: No card
2025-03-27 16:39:29.263 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 16:39:29.265 +08:00 [INF] Card detected: B5DAE224
2025-03-27 16:39:29.266 +08:00 [INF] Processing card: B5DAE224
2025-03-27 16:39:29.267 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 16:39:29.271 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 16:39:29.713 +08:00 [DBG] Received data: No card
2025-03-27 16:44:57.125 +08:00 [INF] Cleaning up resources...
2025-03-27 16:44:57.127 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 122
2025-03-27 16:44:57.133 +08:00 [ERR] Error during resource cleanup
System.ObjectDisposedException: The CancellationTokenSource has been disposed.
   at System.Threading.CancellationTokenSource.Cancel()
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 273
2025-03-27 16:45:07.963 +08:00 [INF] Starting RFID Server...
2025-03-27 16:45:08.004 +08:00 [INF] Connecting to WebSocket...
2025-03-27 16:45:08.052 +08:00 [INF] WebSocket connected successfully
2025-03-27 16:45:08.074 +08:00 [INF] RFID reader connected to COM3
2025-03-27 16:45:15.847 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 16:45:15.851 +08:00 [INF] Card detected: B5DAE224
2025-03-27 16:45:15.853 +08:00 [INF] Processing card: B5DAE224
2025-03-27 16:45:15.906 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 16:45:15.935 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 16:45:16.302 +08:00 [DBG] Received data: No card
2025-03-27 16:46:20.377 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 16:46:20.379 +08:00 [INF] Card detected: B5DAE224
2025-03-27 16:46:20.380 +08:00 [INF] Processing card: B5DAE224
2025-03-27 16:46:20.380 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 16:46:20.384 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 16:46:20.828 +08:00 [DBG] Received data: No card
2025-03-27 16:46:40.355 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 16:46:40.357 +08:00 [INF] Card detected: B5DAE224
2025-03-27 16:46:40.357 +08:00 [INF] Processing card: B5DAE224
2025-03-27 16:46:40.357 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 16:46:40.360 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 16:46:40.703 +08:00 [DBG] Received data: No card
2025-03-27 16:47:32.797 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-27 16:47:32.798 +08:00 [INF] Card detected: B5DAE224
2025-03-27 16:47:32.799 +08:00 [INF] Processing card: B5DAE224
2025-03-27 16:47:32.800 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-27 16:47:32.803 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-27 16:47:33.255 +08:00 [DBG] Received data: No card
2025-03-27 19:03:46.098 +08:00 [INF] Cleaning up resources...
2025-03-27 19:03:46.099 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 122
2025-03-27 19:03:46.537 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 280
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_0>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 27
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_0(Object s, EventArgs e)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 280

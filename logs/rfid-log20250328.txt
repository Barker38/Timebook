2025-03-28 09:15:45.826 +08:00 [INF] Starting RFID Server...
2025-03-28 09:15:45.867 +08:00 [INF] Connecting to WebSocket...
2025-03-28 09:15:45.912 +08:00 [INF] WebSocket connected successfully
2025-03-28 09:15:45.936 +08:00 [INF] RFID reader connected to COM3
2025-03-28 09:16:29.546 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-28 09:16:29.550 +08:00 [INF] Card detected: B5DAE224
2025-03-28 09:16:29.588 +08:00 [INF] Processing card: B5DAE224
2025-03-28 09:16:29.649 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-28 09:16:29.681 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-28 09:16:29.971 +08:00 [DBG] Received data: No card
2025-03-28 09:18:58.175 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-28 09:18:58.177 +08:00 [INF] Card detected: B5DAE224
2025-03-28 09:18:58.178 +08:00 [INF] Processing card: B5DAE224
2025-03-28 09:18:58.178 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-28 09:18:58.182 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-28 09:18:58.516 +08:00 [DBG] Received data: No card
2025-03-28 09:19:44.187 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-28 09:19:44.189 +08:00 [INF] Card detected: B5DAE224
2025-03-28 09:19:44.190 +08:00 [INF] Processing card: B5DAE224
2025-03-28 09:19:44.190 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-28 09:19:44.194 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-28 09:19:44.520 +08:00 [DBG] Received data: No card
2025-03-28 09:19:50.227 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-28 09:19:50.229 +08:00 [INF] Card detected: B5DAE224
2025-03-28 09:19:50.230 +08:00 [INF] Processing card: B5DAE224
2025-03-28 09:19:50.231 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-28 09:19:50.234 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-28 09:19:50.612 +08:00 [DBG] Received data: No card
2025-03-28 09:19:55.478 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-28 09:19:55.480 +08:00 [INF] Card detected: B4FCBC2D
2025-03-28 09:19:55.481 +08:00 [INF] Processing card: B4FCBC2D
2025-03-28 09:19:55.482 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D"}}
2025-03-28 09:19:55.486 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована"}}
2025-03-28 09:19:55.913 +08:00 [DBG] Received data: No card
2025-03-28 09:19:57.118 +08:00 [DBG] Received data: Mifare[B5DAE224] 226,55989 1K (0004,08)
2025-03-28 09:19:57.120 +08:00 [INF] Card detected: B5DAE224
2025-03-28 09:19:57.120 +08:00 [INF] Processing card: B5DAE224
2025-03-28 09:19:57.121 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B5DAE224"}}
2025-03-28 09:19:57.123 +08:00 [DBG] Message sent: {"type":"card_valid","data":{"cardNumber":"B5DAE224","employee":{"id":12,"card_number":"B5DAE224","name":"artem","position":null,"created_at":"2025-03-27T07:20:33.156Z"}}
2025-03-28 09:19:57.479 +08:00 [DBG] Received data: No card
2025-03-28 09:19:58.578 +08:00 [DBG] Received data: Mifare[B4FCBC2D] 188,64692 1K (0004,08)
2025-03-28 09:19:58.579 +08:00 [INF] Card detected: B4FCBC2D
2025-03-28 09:19:58.580 +08:00 [INF] Processing card: B4FCBC2D
2025-03-28 09:19:58.580 +08:00 [DBG] Message sent: {"type":"card_scanned","data":{"cardNumber":"B4FCBC2D"}}
2025-03-28 09:19:58.583 +08:00 [DBG] Message sent: {"type":"card_invalid","data":{"cardNumber":"B4FCBC2D","error":"Карта не зарегистрирована"}}
2025-03-28 09:19:58.906 +08:00 [DBG] Received data: No card
2025-03-28 09:20:25.443 +08:00 [INF] Cleaning up resources...
2025-03-28 09:20:25.445 +08:00 [ERR] Error processing serial port data
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Z2M_Mifare.Program.ProcessSerialPort() in G:\Prog\TimeBook\Program.cs:line 122
2025-03-28 09:20:25.880 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 280
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_1>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 33
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_1(Object sender, ConsoleCancelEventArgs e)
   at System.Console.HandlePosixSignal(PosixSignalContext ctx)
   at System.Runtime.InteropServices.PosixSignalRegistration.HandlerRoutine(Int32 dwCtrlType)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 280
2025-03-28 09:20:25.886 +08:00 [INF] Cleaning up resources...
2025-03-28 09:20:25.887 +08:00 [ERR] Error during resource cleanup
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> System.IO.IOException: Unable to write data to the transport connection: Удаленный хост принудительно разорвал существующее подключение..
 ---> System.Net.Sockets.SocketException (10054): Удаленный хост принудительно разорвал существующее подключение.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.CreateException(SocketError error, Boolean forAsyncThrow)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.SendAsyncForNetworkStream(Socket socket, CancellationToken cancellationToken)
   at System.Net.Sockets.NetworkStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnection.WriteToStreamAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.WriteWithoutBufferingAsync(ReadOnlyMemory`1 source, Boolean async)
   at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendFrameAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 280
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.CleanupResources()
   at Z2M_Mifare.Program.<>c.<<Main>b__7_0>d.MoveNext() in G:\Prog\TimeBook\Program.cs:line 27
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)
   at Z2M_Mifare.Program.<>c.<Main>b__7_0(Object s, EventArgs e)
--- End of stack trace from previous location ---

   --- End of inner exception stack trace ---
   at System.Net.WebSockets.ManagedWebSocket.SendFrameLockAcquiredNonCancelableAsync(MessageOpcode opcode, Boolean endOfMessage, Boolean disableCompression, ReadOnlyMemory`1 payloadBuffer)
   at System.Net.WebSockets.ManagedWebSocket.SendCloseFrameAsync(WebSocketCloseStatus closeStatus, String closeStatusDescription, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.CloseAsyncPrivate(WebSocketCloseStatus closeStatus, String statusDescription, CancellationToken cancellationToken)
   at Z2M_Mifare.Program.CleanupResources() in G:\Prog\TimeBook\Program.cs:line 280
